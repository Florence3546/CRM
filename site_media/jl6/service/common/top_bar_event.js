define("jl6/site_media/service/common/top_bar_event",["require","jl6/site_media/service/common/common","jl6/site_media/service/common/char_link","jl6/site_media/service/common/main_poster_event","jl6/site_media/service/common/poster_store"],function(t,e,n,i,s){function o(){var t=$("body").attr("id");"top_logout"!=t&&e.sendAjax.ajax("get_unread_message_count",null,function(t){s.setUnreadCount(t.count),d(parseInt(t.count))})}n.init();var a=!1,c=!1,r=function(){s.hasGetUnRead()?d(parseInt(s.getUnreadCount())):o()},d=function(t){$("#msg_count").text(t),parseInt(t)>0&&$("#msg_count").removeClass("hide")},u=function(){if(a)return!1;a=!0,$("#suggest button").on("click",function(){if(!$(this).data("is_lock")){var t=this,n=$.trim($("#suggest").find("textarea").val()),i=$.trim($("#suggest").find("input").val());""!=n?($(t).addClass("disabled").text("提交中...").data("is_lock",!0),e.sendAjax.ajax("add_suggest",{suggest:n},function(n){n.error_msg?e.lightMsg.show(n.error_msg):(e.lightMsg.show("感谢您的建议"),$("#suggest").parent().removeClass("active"),$("#suggest").find("textarea").val("")),$(t).data("is_lock",""),$(t).removeClass("disabled").text("提交反馈")}),/^1[3|4|5|7|8]\d{9}$/.test(i)&&e.sendAjax.ajax("submit_userinfo",{phone:i},function(){$("#suggest").find("textarea").val("")})):e.lightMsg.show("请先填写您的宝贵建议")}});$("#id_sync_data").on("click",function(){e.loading.show("正在同步数据，可能耗时较长"),e.sendAjax.ajax("sync_data",{},function(t){e.loading.hide(),void 0!=t.msg&&e.alert.show(t.msg)},function(){e.loading.hide(),e.alert.show("获取服务器数据较慢，请耐心等待，或联系顾问")},{timeout:6e5})}),$("#account_setting .themes a").on("click",function(){var t,n;t=$('link[href*="theme"]'),n=$(this).attr("class"),e.sendAjax.ajax("save_theme",{theme:n},function(){$("#systhemes").val();window.location.reload()})}),$("#account_setting .btn-primary").on("click",function(){var t,n,i;return t=$("#account_setting .switch").hasClass("on")?1:0,n=$.trim($("#account_setting input[name=phone]").val()),i=$.trim($("#account_setting input[name=nick]").val()),!t||!isNaN(n)&&/^1[3|4|5|7|8]\d{9}$/.test(n)?void e.sendAjax.ajax("submit_userinfo",{remind:t,phone:n,nick:i},function(t){e.lightMsg.show("1"==t.remind?"设置成功":"已关闭短信提醒")}):(e.lightMsg.show("手机号码填写不正确！"),!1)}),$("#top_msg").on("click",function(){t(["jl6/site_media/service/my_message/msg_dialog"],function(t){t.show()})}),$("#btn_save_info").on("click",function(){var t=$.trim($("#txt_tel").val()),n=$.trim($("#txt_qq").val());return""==t?(e.lightMsg.show("请输入手机号码。"),!1):isNaN(t)||!/^1[3|4|5|7|8]\d{9}$/.test(t)?(e.lightMsg.show("手机号码填写不正确！"),!1):isNaN(n)?(e.lightMsg.show("QQ号码填写不正确！"),!1):void e.sendAjax.ajax("submit_userinfo",{phone:t,qq:n},function(t){""==t.errMsg?($("#top_user_info").slideUp(500),e.lightMsg.show("恭喜，您的信息已经完善啦，感谢您的配合。")):e.lightMsg.show(t.errMsg)})}),$("#close_user_info").on("click",function(){$("#top_user_info").fadeOut(500)}),$("#account_setting .switch").on("change",function(t,e){e?$("#user_info").removeClass("hidden"):$("#user_info").addClass("hidden")}),$("#site_nav").on("click",".server_menu",function(){i.addViewTimes($(this).attr("value"))}),$("#duplicate_check_id").on("click",function(){e.sendAjax.ajax("to_duplicate_check",{},function(n){return n.no_limit?(t(["jl6/site_media/service/upgrade_suggest/upgrade_suggest_modal"],function(t){t.show("亲，很抱歉！您当前订购的版本没有使用该功能的权限，如果您想使用全店删词功能，就请升级吧！")}),!1):void(n.rpt_flag?e.confirm.show({body:"关键词报表尚未下载完，会影响系统推荐的删词级别，现在就下载报表并排重吗？",okHidden:function(){window.location.href="/web/duplicate_check"}}):window.location.href="/web/duplicate_check")})}),$("#order_shop_check").click(function(){e.sendAjax.ajax("order_shop_check",{},function(){})})},l=function(){return c?!1:(c=!0,$(document).on("scroll",function(){var t=document.body.scrollTop|document.documentElement.scrollTop;98>t?$("#main_content>header").css("marginTop",-t):$("#main_content>header").css("marginTop",-9999)}),void $(document).trigger("scroll"))};return{init:r,baseMain:u,adgMain:l}});