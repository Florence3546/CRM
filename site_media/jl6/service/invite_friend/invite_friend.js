define("jl6/site_media/service/invite_friend/invite_friend",["require","jl6/site_media/plugins/artTemplate/template","jl6/site_media/widget/alert/alert","jl6/site_media/widget/lightMsg/lightMsg","jl6/site_media/widget/ajax/ajax","jl6/site_media/widget/share/share","jl6/site_media/widget/vaildata/vaildata","jl6/site_media/plugins/zclip/jquery.zclip.min"],function(n,e,t,i,a,l){"use strict";var r="亲，已复制订购信息到剪切板中，发送给您的小伙伴，如订购，系统会自动送分哦。",d="亲，订购信息已复制到剪贴板，可以分享到朋友圈、旺旺或QQ群中，如小伙伴们订购并在会员中心填写您的主账号，系统会自动送分哟。",o=function(){return $("#share_anybody").val()},s=function(){var n=l.show(o()),e=$("#share_component");e.html(n)},c=function(){var n=0;$('[data-toggle="tooltip"]').tooltip(),s(),$("#share_btn").click(function(){var e=$(this);if(n%2==0){var t=e.parent().offset().top+e.parent().height(),i=e.offset().left,a=$("#share_component");a.css({top:t,left:i}),a.show(),e.text("收起分享")}else $("#share_component").hide(),e.text("立即分享");n+=1});var e=function(){var n,e,i,l,d,o='<div class="modal fade">\n    <div class="modal-dialog" style="width:500px;">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">生成专属链接</h4>\n            </div>\n            <div class="modal-body">\n                <div>如果你知道哪个小伙伴要订购，请使用这种推荐方式</div>\n                <div class="mt20">\n                    <span class="b mr10">软件版本：</span>\n                    <!--<label class="checkbox-inline">\n                      <input type="radio" name="order_version" value="ts-25811-5"> 基础版\n                    </label>-->\n                    <label class="checkbox-inline">\n                      <input type="radio" name="order_version" value="ts-25811-8"> 双引擎\n                    </label>\n                    <label class="checkbox-inline">\n                      <input type="radio" name="order_version" value="ts-25811-1"> 八引擎\n                    </label>\n                </div>\n                <div class="mt20">\n                    <span class="b mr10">订购周期：</span>\n                    <label class="checkbox-inline">\n                      <input type="radio" name="order_cycle" value="12"> 一年\n                    </label>\n                    <label class="checkbox-inline">\n                      <input type="radio" name="order_cycle" value="6"> 半年\n                    </label>\n                    <label class="checkbox-inline">\n                      <input type="radio" name="order_cycle" value="3"> 一季度\n                    </label>\n                </div>\n                <div class="mt20 hide" id="recommend_box">\n                    <div class="mb10 b">发送内容：</div>\n                    <div class="alert alert-warning f12 lh22">\n                        <div>\n                            新版的开车精灵，不管是操作还是效果，绝对是行业第一的水准，通过下面的链接可以2折优惠订购。\n                        </div>\n                        <div>\n                            软件版本：<span class="order_version">--</span><span class="order_cycle">--</span>优惠价：<span class="current_price">--</span>元&ensp;(原价：<span class="original_price">--</span>元)\n                        </div>\n                        <div>\n                            优惠链接：<span class="url">--</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="modal-footer" style="position: relative;">\n                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>\n                <button type="button" class="btn btn-primary disabled">确定</button>\n            </div>\n        </div>\n    </div>\n</div>\n\n';return n=$.trim($("#recommend_nick").val()),e=$(o),$("body").append(e),e.find("input").on("change",function(){var t,r,o,s;t=$("input[name=order_version]:checked",e).val(),r=$("input[name=order_cycle]:checked",e).val(),o=$("input[name=order_version]:checked",e).parent().text(),s=$("input[name=order_cycle]:checked",e).parent().text(),t&&r&&($("#recommend_box").removeClass("hide"),i=t,l=r,a.ajax("recommend_link",{nick:n,order_version:t,order_cycle:r},function(n){var t=$(".btn-primary",e);e.find(".order_version").text(o),e.find(".order_cycle").text(s),e.find(".current_price").text(n.current_price),e.find(".original_price").text(n.original_price),e.find(".url").text(n.url),d=n,$("html,body").animate({scrollTop:0},0),t.removeClass("disabled")}))}),e.find(".btn-primary").click(function(){var o=$(this);a.ajax("promotion_4shop",{invited_name:n,order_version:i,order_cycle:l,current_price:d.current_price,original_price:d.original_price,url:d.url},function(){p(),o.zclip({path:"/site_media/jl6/plugins/zclip/ZeroClipboard.swf",copy:function(){return $("#recommend_box .alert").text().replace(/\s/g,"")}}),t.show(r),e.modal("hide")})}),e.on("hidden.bs.modal",function(){e.remove()}),e.modal(),!1};$("#generate_link").on("click",function(){var n=function(n){n.error_info.length>0?t.show(n.error_info):e()},i=$.trim($("#recommend_nick").val()),l=$.trim($("#shop_nick").val());return""==i?(t.show("请先输入店铺掌柜ID！"),!1):l==i?(t.show("亲，不能推荐自己哦！"),!1):void a.ajax("check_link_permission",{nick:i},n)}),$("#copy_link").zclip({path:"/site_media/jl6/plugins/zclip/ZeroClipboard.swf",copy:function(){return o()},afterCopy:function(){t.show(d)}}),$("#point_rule").on("click",function(){var n,e='<div class="modal fade">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">送分规则</h4>\n            </div>\n            <div class="modal-body">\n                   <table class="table table-bordered m0">\n                       <thead>\n                           <tr>\n                               <th></th>\n                               <th>一年</th>\n                               <th>半年年</th>\n                               <th>一季度</th>\n                               <th>一月</th>\n                           </tr>\n                       </thead>\n                       <tbody>\n                           <tr>\n                               <td>奖励您自己</td>\n                               <td>5000</td>\n                               <td>4000</td>\n                               <td>2500</td>\n                               <td>1500</td>\n                           </tr>\n                           <tr>\n                               <td>奖励小伙伴</td>\n                               <td>2500</td>\n                               <td>2000</td>\n                               <td>1500</td>\n                               <td>1000</td>\n                           </tr>\n                       </tbody>\n                   </table>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>\n            </div>\n        </div>\n    </div>\n</div>\n';n=$(e),$("body").append(n),n.modal(),n.on("hidden.bs.modal",function(){n.remove()})})},p=function(){var n,i='<table class="pct100 table-bordered">\n  <thead>\n    <tr class="h40">\n      <th class="pl20 vm">给小伙伴的订购连接</th>\n      <th class="tc vm w200">小伙伴订购状态</th>\n      <th class="tc vm w200">您的积分奖励</th>\n    </tr>\n  </thead>\n  {{ if data.length > 0 }}\n	  <tbody>\n	    {{each data}}\n	    <tr class="h40">\n	      <td class="vm p10">\n	        <form class="form-inline">\n	          <div class="form-group">\n	            <input type="text" class="form-control" disabled style="width:600px" value="店铺：{{$value.invited_name}}&emsp;版本：{{$value.order_version_text}}&emsp;周期：{{$value.order_cycle_text}}&emsp;优惠链接：{{$value.url}}">\n	            <button type="button" class="btn btn-default invited_copy">复制链接</button>\n	            <textarea class="hide">新版的开车精灵，不管是操作还是效果，绝对是行业第一的水准，通过下面的链接可以2折优惠订购。软件版本：{{$value.order_version_text}}{{$value.order_cycle_text}}优惠价：{{$value.current_price}}元(原价：{{$value.original_price}}元)优惠链接：{{$value.url}}</textarea>\n	          </div>\n	        </form>\n	      </td>\n	      <td class="tc vm">\n	        <div>\n	          {{if $value.is_freeze == 0 }}\n	            已订购\n	            <div>\n	              小伙伴获得积分\n	              {{if $value.point==5000}}\n	                2500\n	              {{/if}}\n                  {{if $value.point==4000}}\n                    2000\n                  {{/if}}\n                  {{if $value.point==2500}}\n                    1500\n                  {{/if}}\n                  {{if $value.point==1500}}\n                    1000\n                  {{/if}}\n	            </div>\n	          {{else}}\n	            未订购\n	          {{/if}}\n	        </div>\n	      </td>\n	      <td class="tc vm b">\n	        <div class="f16 red">\n	          {{if $value.is_freeze == 0 }}\n	            <span class="b">+{{$value.point}} </span>\n	          {{else}}\n	            无\n	          {{/if}}\n	        </div>\n	      </td>\n	    </tr>\n	    {{/each}}\n     </tbody>\n    {{else}}\n      <tfoot>\n            <tr class="h40" >\n                <td colspan="3" class="tc">\n                    目前没有为小伙伴们创建专属的购买链接\n                </td>\n            </tr>\n      </tfoot>\n    {{/if}}\n</table>\n',l={"ts-25811-1":"八引擎","ts-25811-8":"双引擎"},d={3:"一季度",6:"半年",12:"一年"};a.ajax("point_records",{type:"promotion4shop"},function(a){for(var o in a.data){var s=a.data[o];s.order_version_text=l[s.order_version]?l[s.order_version]:"未知",s.order_cycle_text=d[s.order_cycle]?d[s.order_cycle]:"未知",s.url=s.url?s.url:"http://tb.cn/r5Tt1By"}n=e.compile(i)(a),$("#invited_box").html(n),$("#invited_box").removeClass("dn"),$("#invited_box .invited_copy").each(function(){$(this).zclip({path:"/site_media/jl6/plugins/zclip/ZeroClipboard.swf",copy:function(){return $(this).next().val()},afterCopy:function(){t.show(r)}})})})};return{init:function(){c(),p()}}});