define("jl6/site_media/service/keyword/keyword",["require","jl6/site_media/plugins/artTemplate/template","jl6/site_media/plugins/data-tables/dataTableExt","jl6/site_media/service/common/common","jl6/site_media/plugins/store/store.min","jl6/site_media/plugins/jquery.json-2.4.min","jl6/site_media/widget/templateExt/templateExt","jl6/site_media/service/report_detail/report_detail","jl6/site_media/widget/selectSort/selectSort","jl6/site_media/plugins/moment/moment.min","jl6/site_media/plugins/jquery/jquery.min"],function(e,t,i,a,o,n,r,s,c,l,d){"use strict";var p,h,u,m=0;d.fn.dataTableExt.afnSortData["custom-weird"]=function(e,t){return d.map(e.oApi._fnGetTrNodes(e),function(i,a){var o,n=e.oApi._fnGetTdNodes(e,a)[t],r=Number(i.getAttribute("data-weird-"+e.aaSorting[0][1]));return o=Number(-1!=n.className.indexOf("sort_custom")?d(n).find("span:first").text():d(n).text().replace("%","")),-1!=i.className.indexOf("unsort")?"unsort":p&&r?r+o:o})};var f=function(e){var i,a,o='<div class="dropdown-menu dropdown-table">\n    <div>\n        <ul>\n            {{each data as v k}}\n                {{if v.cond.length}}\n                    <li data-id="{{v.id}}">\n                        <span class="title tr">{{v.name}}</span>\n                        {{each v.cond}}\n                        <label class="checkbox-inline">\n                            <input type="checkbox" data-title="{{v.name}}" data-status="{{$value.text}}" value="{{$value.cls}}">{{$value.text}}&ensp;<span class="sub">({{$value.count}}个{{if $value.range[0]}}，范围{{$value.range[0]}}-{{$value.range[1]}}{{/if}})</span>\n                        </label>\n                        {{/each}}\n                        {{if v.custom}}\n                        <span class="ml20">自定义</span>\n                        <input type="text">&ensp;-&ensp;<input type="text">\n                        {{/if}}\n                    </li>\n                {{/if}}\n            {{/each}}\n        </ul>\n    </div>\n\n    <div class="lh30">\n        <button type="button" class="btn btn-primary btn-sm">确定</button>\n        <button type="button" class="btn btn-default btn-sm">取消</button>\n    </div>\n</div>\n';i=t.compile(o)(e),a=d(i),e.element.next().remove(),d("#filter_label").html("").removeClass("active"),e.element.after(a),a.on("click.data.filter",function(e){e.stopPropagation()})},b=function(e){return isNaN(e)||.05>e||e>99.99?!1:!0},_=function(e,t,i){this.checked=!1,this.up=!1,this.down=!1,this.del=!1,this.nRow=e,this.warnPrice=t,this.mobileWarnPrice=i,this.mnt=null,this.match=null,this.initData(),this.initEvent()};_.prototype.initData=function(){this.data=d(this.nRow).data(),this.keywordId=this.nRow.id,this.maxPrice=Number(this.data.max_price),this.maxMobilePrice=Number(this.data.max_mobile_price),this.match=Number(this.data.match),this.mnt=this.data.mnt,this.adgroupId=this.data.adgroup_id,this.campaignId=this.data.campaign_id,this.word=d(this.nRow).find(".word").text(),this.limit=!1,this.mobuleLimit=!1,this.maxPrice>=this.warnPrice&&(this.limit=!0),this.maxMobilePrice>=this.mobileWarnPrice&&(this.mobileLimit=!0),this.newPriceInput=d(this.nRow).find(".new_price"),this.newMobilePriceInput=d(this.nRow).find(".new_mobile_price"),this.checkboxInput=d(this.nRow).find("[type=checkbox]"),this.sortSpan=d(this.nRow).find(".main_sort")},_.prototype.initEvent=function(){var i=this;d(this.nRow).on("change.Row.new_price",".new_price",function(){i.newPriceInput.val(b(this.value)?Number(this.value).toFixed(2):i.maxPrice),i.updateStyle(1),i.calcChangeNum()}),d(this.nRow).on("change.Row.new_price",".new_mobile_price",function(){i.newMobilePriceInput.val(b(this.value)?Number(this.value).toFixed(2):i.maxMobilePrice),i.updateStyle(2),i.calcChangeNum()}),d(this.nRow).on("click.Row.recovery",".recovery",function(e){i.recovery(e,1),i.data.locked||i.newPriceInput.attr("disabled",!1),i.calcChangeNum()}),d(this.nRow).on("click.Row.recovery_mobile",".recovery_mobile",function(e){i.recovery(e,2),i.data.locked||i.newMobilePriceInput.attr("disabled",!1),i.calcChangeNum()}),d(this.nRow).on("click.Row.del",".del",function(){i.del=i.del?!1:!0,i.updateStyle(),i.calcChangeNum()}),s.init(0,1),d(this.nRow).on("click.Row.chart",".chart",function(){var e;e=d(i.nRow).find(".word").text(),s.show("关键词明细："+e,"keyword",d("#shop_id").val(),null,i.adgroupId,null,i.nRow.id)}),d(this.nRow).find("i.mnt").popoverList({trigger:"click",placement:"bottom",content:'<ul>\n  <li data-value="0" data-icon="&#xe653;"><i class="iconfont">&#xe653;</i>自动优化</li>\n  <li data-value="1" data-icon="&#xe654;"><i class="iconfont">&#xe654;</i>只改价</li>\n  <li data-value="2" data-icon="&#xe655;"><i class="iconfont">&#xe655;</i>不托管</li>\n</ul>\n',html:!0,onChange:function(e){i.setMntType(e.value),i.calcChangeNum()}}),d(this.nRow).find("i.mnt").on("shown.bs.popoverList",function(){d(this).find("li[data-value="+i.mnt+"]").addClass("active")}),d(this.nRow).find("i.match").popoverList({trigger:"click",placement:"bottom",content:'<ul>\n  <li data-value="4"><i class="iconfont">&#xe623;</i>广泛匹配</li>\n  <!--<li data-value="2"><i class="iconfont">&#xe624;</i>中心匹配</li>-->\n  <li data-value="1"><i class="iconfont">&#xe622;</i>精确匹配</li>\n</ul>\n',html:!0,onChange:function(e){i.setMatchScorp(e.value),i.calcChangeNum()}}),d(this.nRow).find("i.match").on("shown.bs.popoverList",function(){d(this).find("li[data-value="+i.match+"]").addClass("active")}),d(this.nRow).find("td.qscore").popoverList({trigger:"hover",placement:"right",html:!0,content:function(){return t.compile('<div class="qscore_details black">\n    <div class="item">\n        <h4 class="mb20">计算机质量得分&ensp;<span class="base_color">{{pc_qscore}}</span>分<span class="f12 text-muted">（1-10）</span></h4>\n        <div class="bar">\n            <div class="l">创意质量：</div>\n            <div class="l">\n            {{each [0,1,2,3,4]}}\n                <span class="scroe_item {{if $index<pc_creative_score }}base_color{{else}}gray{{/if}}"></span>\n            {{/each}}\n            <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="推广创意近期的关键词动态点击反馈">&#xe628;</i>\n            </div>\n        </div>\n        <div class="bar">\n            <div class="l">相&ensp;关&ensp;性：</div>\n            <div class="l">\n            {{each [0,1,2,3,4]}}\n                <span class="scroe_item {{if $index<pc_rele_score }}base_color{{else}}gray{{/if}}"></span>\n            {{/each}}\n            <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="关键词与宝贝类目、属性及文本等信息的相符程度">&#xe628;</i>\n            </div>\n        </div>\n        <div class="bar">\n            <div class="l">买家体验：</div>\n            <div class="l">\n            {{each [0,1,2,3,4]}}\n                <span class="scroe_item {{if $index<pc_cvr_score }}base_color{{else}}gray{{/if}}"></span>\n            {{/each}}\n            <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="根据买家在店铺的购买体验给出的动态反馈">&#xe628;</i>\n            </div>\n        </div>\n        <div class="bar">\n            <div class="l mt5">展示机会：</div>\n            <div class="l">\n                {{if plflag == "0"}}\n                    <i class="iconfont f30 none">&#xe65f;</i><span class="ml5 gray va6 f12">无PC左推机会</span>\n                    <i class="iconfont va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="暂无机会在PC端首页左侧推广位置展示">&#xe628;</i>\n                {{/if}}\n                {{if plflag == "1"}}\n                    <i class="iconfont f30 chance">&#xe626;</i><span class="ml5 gray va6 f12">有PC左推机会</span>\n                    <i class="iconfont va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="有机会在PC端首页左侧推广位置展示">&#xe628;</i>\n                {{/if}}\n            </div>\n        </div>\n    </div>\n    <div class="item">\n        <h4 class="mb20">移动质量得分&ensp;<span class="base_color">{{yd_qscore}}</span>分<span class="f12 text-muted">（1-10）</span></h4>\n        {{if yd_qscore > -1}}\n            {{if yd_qscore > 0 }}\n            <div class="bar">\n                <div class="l">创意质量：</div>\n                <div class="l">\n                {{each [0,1,2,3,4]}}\n                    <span class="scroe_item {{if $index<yd_creative_score }}base_color{{else}}gray{{/if}}"></span>\n                {{/each}}\n                <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="推广创意近期的关键词动态点击反馈">&#xe628;</i>\n                </div>\n            </div>\n            <div class="bar">\n                <div class="l">相&ensp;关&ensp;性：</div>\n                <div class="l">\n                {{each [0,1,2,3,4]}}\n                    <span class="scroe_item {{if $index<yd_rele_score }}base_color{{else}}gray{{/if}}"></span>\n                {{/each}}\n                <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="关键词与宝贝类目、属性及文本等信息的相符程度">&#xe628;</i>\n                </div>\n            </div>\n            <div class="bar">\n                <div class="l">买家体验：</div>\n                <div class="l">\n                {{each [0,1,2,3,4]}}\n                    <span class="scroe_item {{if $index<yd_cvr_score }}base_color{{else}}gray{{/if}}"></span>\n                {{/each}}\n                <i class="iconfont" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="根据买家在店铺的购买体验给出的动态反馈">&#xe628;</i>\n                </div>\n            </div>\n            <div class="bar">\n                <div class="l mt5">展示机会：</div>\n                <div class="l">\n                    {{if matchflag == "0"}}\n                        <i class="iconfont f30 none">&#xe659;</i><span class="gray va6 f12">无移动展示机会</span><i class="iconfont ml5 va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="暂无移动端暂时机会">&#xe628;</i>\n                    {{/if}}\n                    {{if matchflag == "1"}}\n                        <i class="iconfont f30 none">&#xe659;</i><span class="gray va6 f12">无移动展示机会</span><i class="iconfont ml5 va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="暂无移动端暂时机会">&#xe628;</i>\n                    {{/if}}\n                    {{if matchflag == "2"}}\n                        <i class="iconfont f30 chance">&#xe65a;</i><span class="gray va6 f12">有移动展示机会</span><i class="iconfont ml5 va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="有机会在手机移动端展示">&#xe628;</i>\n                    {{/if}}\n                    {{if matchflag == "4"}}\n                        <i class="iconfont f30 top">&#xe658;</i><span class="gray va6 f12">有首屏展示机会</span><i class="iconfont ml5 va6" data-toggle="tooltip" data-placement="bottom" data-trigger="hover" title="有机会在移动端第一屏展示">&#xe628;</i>\n                    {{/if}}\n                </div>\n            </div>\n            {{/if}}\n            {{if yd_qscore == 0 }}\n                <p class="text-muted">请检查宝贝的创意是否正常</p>\n            {{/if}}\n        {{else}}\n            <p class="text-muted">移动端未开启投放</p>\n        {{/if}}\n    </div>\n</div>\n')({yd_qscore:Number(d(this).attr("yd_qscore")),yd_creative_score:d(this).attr("yd_creative_score"),yd_rele_score:d(this).attr("yd_rele_score"),yd_cvr_score:d(this).attr("yd_cvr_score"),pc_qscore:d(this).attr("pc_qscore"),pc_creative_score:d(this).attr("pc_creative_score"),pc_rele_score:d(this).attr("pc_rele_score"),pc_cvr_score:d(this).attr("pc_cvr_score"),plflag:d(this).attr("plflag"),matchflag:d(this).attr("matchflag")})}}),d(this.nRow).find("td.qscore").on("shown.bs.popoverList",function(){d(i.nRow).find(".popover i[data-toggle=tooltip]").tooltip()}),d(this.nRow).on("click.rob",".rob",function(){d(i.nRow).trigger("show.rob",[d.extend({},u,{method:"manual"})])}),d(this.nRow).on("show.rob",function(t,o){var n;return n={keywordId:i.keywordId,adgroupId:i.adgroupId,word:i.word,maxPrice:i.maxPrice,maxMobilePrice:i.maxMobilePrice,qscore:i.data.qscore,wirelessQscore:i.data.wireless_qscore,pcRank:d(i.nRow).find(".pc_rank_desc").text(),ydRank:d(i.nRow).find(".mobile_rank_desc").text()},n=d.extend({},n,o),e(["jl6/site_media/service/rob_rank/rob_rank"],function(e){h?(n.rank_desc_map=h,e.show(n)):a.sendAjax.ajax("rank_desc_map",{},function(t){h=t.result,n.rank_desc_map=h,e.show(n)})}),!1}),d(this.nRow).on("click.rob_record",".rob_record",function(){return e(["jl6/site_media/service/rob_rank/rob_record"],function(e){e.show({keywordId:i.keywordId})}),!1}),d(this.nRow).on("click.rob_set",".rob_set",function(){return a.sendAjax.ajax("rob_config",{keyword_id:i.keywordId},function(e){d(i.nRow).trigger("show.rob",{method:"auto",platform:e.data.platform,rank_start:e.data.rank_start,rank_end:e.data.rank_end,limit:(e.data.limit/100).toFixed(2),nearly_success:e.data.nearly_success,start_time:e.data.start_time,end_time:e.data.end_time})}),!1}),d(this.nRow).on("update.rank",function(e,t,i,a,o){d(this).find(".pc_rank").text(t),d(this).find(".mobile_rank").text(i),d(this).find(".pc_rank_desc").text(a),d(this).find(".mobile_rank_desc").text(o)}),d(this.nRow).on("saveOptions.rank",function(e,t){u=t}),d(this.nRow).on("update.rob_rank",function(e,t,a,o){var n;i.data.locked=0,"nomal"==t&&(n='<a href="javascript:;" class="rob">抢</a>'),"fail"==t&&(n='<a href="javascript:;" class="rob_record">手动抢失败</a><a href="javascript:;" class="rob ml5">再抢</a>'),"success"==t&&("pc"==o?(i.maxPrice=a,i.data.max_price=a,i.newPriceInput.val(a),d(this).find(".max_price").text(a)):(i.maxMobilePrice=a,i.data.max_mobile_price=a,i.newMobilePriceInput.val(a),d(this).find(".max_mobile_price").text(a)),n='<a href="javascript:;" class="rob_record">手动抢成功</a><a href="javascript:;" class="rob ml5">再抢</a>'),"auto"==t&&(i.data.locked=1,n='<a href="javascript:;" class="rob_record">已设为自动</a><a href="javascript:;" class="rob_set ml5">设置</a>'),"doing"==t&&(n='<a href="javascript:;" class="rob_doing">正在抢排名，请稍候</a>'),d(this).find(".rob_rank").html(n),i.updateStyle()})},_.prototype.updateStatus=function(e){if(void 0==e?e=3:"",1&e){var t=Number(this.newPriceInput.val());this.up=!1,this.down=!1,this.limit=!1,t>this.maxPrice&&(this.up=!0),t<this.maxPrice&&(this.down=!0),t>this.warnPrice&&(this.limit=!0)}if(2&e){var i=Number(this.newMobilePriceInput.val());this.mobileUp=!1,this.mobileDown=!1,this.mobileLimit=!1,i>this.maxMobilePrice&&(this.mobileUp=!0),i<this.maxMobilePrice&&(this.mobileDown=!0),i>this.mobileWarnPrice&&(this.mobileLimit=!0)}},_.prototype.updateStyle=function(e){void 0==e?e=3:"",this.updateStatus(e),1&e&&(d(this.nRow).removeClass("up down limit del"),this.newPriceInput.attr("disabled",!1),this.up&&d(this.nRow).addClass("up"),this.down&&d(this.nRow).addClass("down"),this.limit&&d(this.nRow).addClass("limit")),2&e&&(d(this.nRow).removeClass("del mobileUp mobileDown mobileLimit"),this.newMobilePriceInput.attr("disabled",!1),this.mobileUp&&d(this.nRow).addClass("mobileUp"),this.mobileDown&&d(this.nRow).addClass("mobileDown"),this.mobileLimit&&d(this.nRow).addClass("mobileLimit")),this.del&&(this.newPriceInput.attr("disabled",!0),this.newMobilePriceInput.attr("disabled",!0),d(this.nRow).addClass("del")),this.data.locked&&(this.newPriceInput.attr("disabled",!0),this.newMobilePriceInput.attr("disabled",!0))},_.prototype.recovery=function(e,t){this.del=!1,this.up=!1,this.down=!1,this.mobileUp=!1,this.mobileDown=!1,this.limit=!1,this.mobileLimit=!1,this.maxPrice>this.warnPrice&&(this.limit=!0),this.maxMobilePrice>this.mobileWarnPrice&&(this.mobileLimit=!0),this.newPriceInput.val()!=this.maxPrice&&1&t&&this.newPriceInput.val(this.maxPrice.toFixed(2)),this.newMobilePriceInput.val()!=this.maxMobilePrice&&2&t&&this.newMobilePriceInput.val(this.maxMobilePrice.toFixed(2)),this.updateStyle()},_.prototype.setRowUp=function(e,t){this.sortSpan.text(void 0!=t?t:1),void 0!=e?this.checkboxInput[0].checked=e:""},_.prototype.setRowDown=function(e){this.sortSpan.text(0),void 0!=e?this.checkboxInput[0].checked=e:""},_.prototype.bulkPlus=function(e,t,i,a,o,n){if(this.del||this.data.locked)return!1;var r;if(r="max_price"==e||"g_cpc"==e?"int"==a?t+i:t*(1+i/100):t,r>o&&(r=o),"max_price"==e){if(1&n&&r<this.maxPrice)return this.newPriceInput.val(this.maxPrice.toFixed(2)),void this.updateStyle(n);if(2&n&&r<this.maxMobilePrice)return this.newMobilePriceInput.val(this.maxMobilePrice.toFixed(2)),void this.updateStyle(n)}.05>r&&(r=.05),r>99.99&&(r=this.maxPrice),1&n&&this.newPriceInput.val((parseInt(Math.ceil((100*r).toFixed(1)))/100).toFixed(2)),2&n&&this.newMobilePriceInput.val((parseInt(Math.ceil((100*r).toFixed(1)))/100).toFixed(2)),this.updateStyle(n)},_.prototype.fallPlus=function(e,t,i,a,o,n){if(this.del||this.data.locked)return!1;var r;if(r="int"==a?t-i:t*(1-i/100),o>r&&(r=o),"max_price"==e){if(1&n&&r>this.maxPrice)return this.newPriceInput.val(this.maxPrice.toFixed(2)),void this.updateStyle(n);if(2&n&&r>this.maxMobilePrice)return this.newMobilePriceInput.val(this.maxMobilePrice.toFixed(2)),void this.updateStyle(n)}.05>r&&(r=.05),r>99.99&&(r=this.maxPrice),1&n&&this.newPriceInput.val((parseInt(Math.floor((100*r).toFixed(1)))/100).toFixed(2)),2&n&&this.newMobilePriceInput.val((parseInt(Math.floor((100*r).toFixed(1)))/100).toFixed(2)),this.updateStyle()},_.prototype.setMatchScorp=function(e){if(this.del)return!1;var t={4:"&#xe623;",2:"&#xe624;",1:"&#xe622;"};this.match=e,d(this.nRow).find(".match").html(t[e])},_.prototype.setMntType=function(e){if(this.del)return!1;var t={0:"&#xe653;",1:"&#xe654;",2:"&#xe655;"};this.mnt=e,d(this.nRow).find(".mnt").html(t[e])},_.prototype.getTableElement=function(){return d(this.nRow).parent().parent()},_.prototype.calcChangeNum=function(){var e=this.getTableElement();e.trigger("calcChangeNum")};var w=function(e){this.config={warnPrice:5,mobileWarnPrice:5,weird:!1,hideColumn:["cpm","avgpos","favcount","favctr","favpay","s_favcount","a_favcount","carttotal","z_paycount","j_paycount","z_pay","j_pay","g_pv","g_click","g_cpc","g_ctr","g_competition","create_days","g_paycount","g_roi","g_coverage"],classDict:{ROI:[6e9,1e9,"有转化"],FAV:[5e9,2e9,"有收藏，无转化"],CLICK:[4e9,3e9,"有点击，无收藏，无转化"],PV:[3e9,4e9,"有展现，无点击"],NOPV:[2e9,5e9,"无展现"],FRESH:[1e9,6e9,"今日新加词"]},classBase:"data-tree-code",headerMarginTop:0,useStore:!0,aoColumns:[{bSortable:!1},{bSortable:!0,sSortDataType:"custom-weird",sType:"custom"},{bSortable:!1},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!1},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!1},{bSortable:!1,sType:"custom",sSortDataType:"custom-weird"},{bSortable:!1},{bSortable:!1,sType:"custom",sSortDataType:"custom-weird"},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird"},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]},{bSortable:!0,sType:"custom",sSortDataType:"custom-weird",asSorting:["desc","asc"]}]},this.options=d.extend({},this.config,e),this.options.useStore&&(p||o.get("weird_switch"))&&(d("#weird_switch").addClass("on"),p=!0);var t=this.options.element.find("tbody tr").length;d(".keywords_count").text(t-1),t>1?(d("#operation_bar").removeClass("hide"),this.sortTable(),this.fixTableWidth(),this.options.element.addClass("active"),d("#keyword_no_data").hide()):(d("#keyword_no_data").addClass("active"),this.options.element.hide()),this.initEvent(),this.startWeirdClass(),this.options.layoutCallback&&this.options.layoutCallback.apply(this)};return w.prototype.COLUM_DICT={keyword:2,max_price:3,new_price:4,max_mobile_price:5,new_mobile_price:6,rank:7,rob:8,qscore:9,create_days:10,impressions:11,click:12,ctr:13,cost:14,ppc:15,cpm:16,avgpos:17,favcount:18,s_favcount:19,a_favcount:20,favctr:21,favpay:22,carttotal:23,paycount:24,z_paycount:25,j_paycount:26,pay:27,z_pay:28,j_pay:29,conv:30,roi:31,g_pv:32,g_click:33,g_ctr:34,g_coverage:35,g_roi:36,g_cpc:37,g_competition:38,g_paycount:39},w.prototype.sortTable=function(){var e,t=this;this.rowCache={},e=this.options.hideColumn.length?this.options.hideColumn:this.config.hideColumn;for(var i in e)"undefined"!=typeof this.COLUM_DICT[e[i]]&&(this.options.aoColumns[this.COLUM_DICT[e[i]]].bVisible=!1);this.table=this.options.element.dataTable({bRetrieve:!0,bPaginate:!1,bFilter:!1,bInfo:!1,bAutoWidth:!1,sDom:"Tlfrtip",aaSorting:[[1,"desc"]],aoColumns:this.options.aoColumns,fnCreatedRow:function(e,i,a){var o;if(-1==e.className.indexOf("unsort"))if(o=new _(e,t.options.warnPrice,t.options.mobileWarnPrice),o.aData=i,o.iDisplayIndex=a,t.rowCache[o.keywordId]=o,o.data.treeCode){var n=o.data.treeCode;e.setAttribute("data-weird-desc",t.options.classDict[n][0]),e.setAttribute("data-weird-asc",t.options.classDict[n][1])}else e.setAttribute("data-weird-desc",0),e.setAttribute("data-weird-asc",0)},fnHeaderCallback:function(e){d(e).find("th").removeClass("hide")},oTableTools:{sSwfPath:"/site_media/jl6/swf/copy_csv_xls.swf",aButtons:[{sExtends:"xls",sTitle:t.getAdgroupTitle(),fnClick:function(e,i,a){this.fnSetText(a,t.getCsvData())}}],custom_btn_id:"save_as_csv"},oLanguage:{sZeroRecords:"没有关键词记录"},fnDrawCallback:function(){var e=this;e.find(".check_column").off(".shiftcheckbox").shiftcheckbox({checkboxSelector:"input",complete:function(){t.checkCallback()}}),e.find(".check_column").off("click.checkCallback").on("click.checkCallback","input",function(){t.checkCallback()}),e.find(".all input").off("change").on("change",function(){var i=this;e.find("tbody>tr>td>input[type=checkbox]").each(function(){this.checked=i.checked}),t.setChecked()}),t.startWeirdClass()}})},w.prototype.initEvent=function(){var t=this;d(".fixedHeader").length&&d(".fixedHeader").remove(),t.table&&(t.fixHeader=new FixedHeader(t.table,{offsetTop:t.options.headerMarginTop})),d("#recovery_all").off("click.Table.recovery_all").on("click.Table.recovery_all",function(e){for(var i in t.rowCache)t.rowCache[i].recovery(e,1),t.rowCache[i].newPriceInput.attr("disabled",!1);t.calcChangeNum()}),d("#recovery_mobile_all").off("click.Table.recovery_mobile_all").on("click.Table.recovery_mobile_all",function(e){for(var i in t.rowCache)t.rowCache[i].recovery(e,2),t.rowCache[i].newMobilePriceInput.attr("disabled",!1);t.calcChangeNum()}),d("#rank_all").off("click.Table.rank_all").on("click.Table.rank_all",function(){if(d(this).hasClass("disabled"))return!1;var e=[],i=d(this).text(),o=this;d(this).addClass("disabled").text("正在更新");for(var n in t.rowCache)e.push({adgroup_id:t.rowCache[n].adgroupId,keyword_id:t.rowCache[n].keywordId});a.sendAjax.ajax("batch_get_rt_kw_rank",{keyword_id_list:d.toJSON(e)},function(e){for(var a in e.rank_result){{var n=e.rank_result[a];d(t.rowCache[a].nRow)}d(t.rowCache[a].nRow).find(".pc_rank_desc").text(n.pc_rank_desc),d(t.rowCache[a].nRow).find(".mobile_rank_desc").text(n.mobile_rank_desc),d(t.rowCache[a].nRow).find(".pc_rank").text(n.pc_rank<0?100*n.pc_rank:n.pc_rank),d(t.rowCache[a].nRow).find(".mobile_rank").text(n.mobile_rank<0?100*n.mobile_rank:n.mobile_rank)}d(document).trigger("batch_rt_kw_rank",[e.rank_result]),d(o).removeClass("disabled").text(i),d("#rank_time").text(l().format("H:mm"))})}),d("#filter_warp").off("change.Table.filter").on("change.Table.filter","input[type=checkbox]",function(){t.filterKwList()}),d("#filter_label").off("click.Table.select").on("click.Table.select",".select",function(){for(var e,e=0,i=d(this).find("i").data().value.split(","),a=i.length;a>e;e++)d("#filter_warp li[data-id="+i[e]+"]").length?d("#filter_warp li[data-id="+i[e]+"]").find("input[type=text]").val(""):d("#filter_warp input[type=checkbox][value="+i[e]+"]").attr("checked",!1);t.filterKwList()}),d("#filter_warp .dropdown-menu .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){d("#filter_warp").removeClass("open"),t.filterKwList()}),d("#filter_warp .dropdown-menu .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#filter_warp").removeClass("open")}),d("#price_warp .radio:lt(6)").find("select,input[type=text]").off("focus.Table.select").on("focus.Table.select",function(){d(this).parent().find("input[type=radio]")[0].checked=!0}),d("#price_warp .radio:eq(2) input[type=text],#price_warp .radio:eq(4) input[type=text]").off("change.autoComplate").on("change.autoComplate",function(){d(this).val(isNaN(this.value)?"":Number(this.value).toFixed(2))}),d("#price_warp .radio:eq(0) input[type=text],#price_warp .radio:eq(6) input[type=text]").off("change.autoComplate").on("change.autoComplate",function(){d(this).val(b(this.value)?Number(this.value).toFixed(2):"")}),d("#price_warp .dropdown-menu .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#price_warp").removeClass("open")}),d("#price_warp .dropdown-menu .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){var e,i,o;e=d("#price_warp input[type=radio]:checked").val(),o=parseFloat(d("#price_limit").val()),e?(i=t.checkedRow(),i.length?(t["changePrice8"+e](i,o,1),t.calcChangeNum()):(a.lightMsg.show("没有选中任何关键词！"),d("#price_warp").removeClass("open"))):a.lightMsg.show("请选择改价类型")}),d("#mobile_price_warp .radio:lt(6)").find("select,input[type=text]").off("focus.Table.select").on("focus.Table.select",function(){d(this).parent().find("input[type=radio]")[0].checked=!0}),d("#mobile_price_warp .radio:eq(2) input[type=text],#mobile_price_warp .radio:eq(4) input[type=text]").off("change.autoComplate").on("change.autoComplate",function(){d(this).val(isNaN(this.value)?"":Number(this.value).toFixed(2))}),d("#mobile_price_warp .radio:eq(0) input[type=text],#mobile_price_warp .radio:eq(6) input[type=text]").off("change.autoComplate").on("change.autoComplate",function(){d(this).val(b(this.value)?Number(this.value).toFixed(2):"")}),d("#mobile_price_warp .dropdown-menu .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#mobile_price_warp").removeClass("open")}),d("#mobile_price_warp .dropdown-menu .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){var e,i,o;e=d("#mobile_price_warp input[type=radio]:checked").val(),o=parseFloat(d("#price_limit_mobile").val()),e?(i=t.checkedRow(),i.length?(t["changePrice8"+e](i,o,2),t.calcChangeNum()):(a.lightMsg.show("没有选中任何关键词！"),d("#mobile_price_warp").removeClass("open"))):a.lightMsg.show("请选择改价类型")}),d("#bluk_del").off("click.Table.del").on("click.Table.del",function(){var e=t.checkedRow();if(e.length){for(var i=0,o=e.length;o>i;i++){var n=t.rowCache[e[i][0].id];n.del=!0,n.updateStyle(),t.calcChangeNum()}t.calcChangeNum()}else a.lightMsg.show("没有选中任何关键词！")}),d("#match_warp .dropdown-menu .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){var e=Number(d("#match_warp .dropdown-menu input[type=radio]:checked").val()),i=t.checkedRow();if(i.length){for(var o=0,n=i.length;n>o;o++){var r=t.rowCache[i[o][0].id];r.setMatchScorp(e)}d("#match_warp").removeClass("open"),t.calcChangeNum()}else a.lightMsg.show("没有选中任何关键词！");d("#match_warp").removeClass("open")}),d("#match_warp .dropdown-menu .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#match_warp").removeClass("open")}),d("#mnt_warp .dropdown-menu .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){var e=Number(d("#mnt_warp .dropdown-menu input[type=radio]:checked").val()),i=t.checkedRow();if(i.length){for(var o=0,n=i.length;n>o;o++){var r=t.rowCache[i[o][0].id];r.setMntType(e)}d("#mnt_warp").removeClass("open"),t.calcChangeNum()}else a.lightMsg.show("没有选中任何关键词！");d("#mnt_warp").removeClass("open")}),d("#mnt_warp .dropdown-menu .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#mnt_warp").removeClass("open")}),this.table&&this.table.off("calcChangeNum").on("calcChangeNum",function(){t.calcChangeNum()}),this.table&&this.table.off("delete_row").on("delete_row",function(e,i){t.delete_row(i)}),d("#show_more_keyword .dropdown-menu>ul").each(function(){d(this).find(".checkbox-inline").shiftcheckbox({checkboxSelector:"input",selectAll:d(this).find(".title")})}),d("#show_more_keyword").off("shown.bs.dropdown").on("shown.bs.dropdown",function(){var e=d(this).find("ul"),i=t.getHideColumn();d("input[type=checkbox]",e).each(function(){this.checked=!0});for(var a in i)"undefined"!=typeof t.COLUM_DICT[i[a]]&&d("input[value="+i[a]+"]",e).trigger("click")}),d("#show_more_keyword .btn-primary").off("click.Table.btn-primary").on("click.Table.btn-primary",function(){var e=[],i=[];d("#show_more_keyword input[type=checkbox][value]").each(function(){this.checked||"undefined"==typeof t.COLUM_DICT[this.value]||(i.push(t.COLUM_DICT[this.value]),e.push(this.value))}),t.setHideCloumn(i),d("#show_more_keyword").removeClass("open"),a.sendAjax.ajax("save_custom_column",{column:e},null)}),d("#show_more_keyword .btn-default").off("click.Table.btn-default").on("click.Table.btn-default",function(){d("#show_more_keyword").removeClass("open")}),d("#weird_switch").off("change.Table").on("change.Table",function(e,i){i?(p=!0,t.table.fnSort([[1,"desc"]]),o.set("weird_switch",!0)):(p=!1,t.closeWeirdClass(),o.set("weird_switch",!1))}),d(".search_btn").off("click.Table").on("click.Table",function(){var e=d(this).prev().val();d(".search_btn").prev().val(e),""!=e?t.searchWordAndSort(e):a.lightMsg.show("请填写要搜索的关键词")}),d(".search_val").off("keyup.Table").on("keyup.Table",function(e){13==e.keyCode&&(d(this).siblings(".search_btn").click(),d(this).focus())}),d(".select_status").off("click.Table").on("click.Table",function(){var e=parseInt(d(this).attr("mode"));for(var i in t.rowCache){var a=t.rowCache[i],o=!1;switch(e){case 0:a.up&&(o=!0);break;case 1:a.down&&(o=!0);break;case 2:a.del&&(o=!0);break;case 3:a.match!=a.data.match&&(o=!0);break;case 4:a.mnt!=a.data.mnt&&(o=!0);
break;case 5:a.mobileUp&&(o=!0);break;case 6:a.mobileDown&&(o=!0)}o?a.setRowUp(!0):a.setRowDown(!1)}p||t.table.fnSort([[1,"desc"]]),t.checkCallback()}),d("#warn_price .edit i").off("click.Table").on("click.Table",function(){if(d(this).hasClass("disabled"))return!1;var e=Number(d("#warn_price .edit span").text()).toFixed(2);d("#warn_price .save input").val(e),d("#warn_price ").addClass("active")}),d("#mobile_warn_price .edit i").off("click.Table").on("click.Table",function(){if(d(this).hasClass("disabled"))return!1;var e=Number(d("#mobile_warn_price .edit span").text()).toFixed(2);d("#mobile_warn_price .save input").val(e),d("#mobile_warn_price ").addClass("active")}),d("#warn_price .save a").off("click.Table").on("click.Table",function(){var e=d("#warn_price .save input").val();if(b(e)){if(d("#warn_price ").removeClass("active"),Number(d("#warn_price .edit span").text())==Number(e))return;d("#warn_price .edit span").text(Number(e).toFixed(2));for(var i in t.rowCache){var o=t.rowCache[i];o.warnPrice=Number(e),o.updateStyle()}t.options.warnPrice=e,a.sendAjax.ajax("set_adg_limit_price",{adgroup_id:d("#adgroup_id").val(),limit_price:e},function(){a.lightMsg.show("修改PC限价成功")})}else a.lightMsg.show("限价不能为空，必须为0.05元~99.99元之间");return!1}),d("#mobile_warn_price .save a").off("click.Table").on("click.Table",function(){var e=d("#mobile_warn_price .save input").val();if(b(e)){if(d("#mobile_warn_price ").removeClass("active"),Number(d("#mobile_warn_price .edit span").text())==Number(e))return;d("#mobile_warn_price .edit span").text(Number(e).toFixed(2));for(var i in t.rowCache){var o=t.rowCache[i];o.mobileWarnPrice=Number(e),o.updateStyle()}t.options.mobileWarnPrice=e,a.sendAjax.ajax("set_adg_limit_price",{adgroup_id:d("#adgroup_id").val(),mobile_limit_price:e},function(){a.lightMsg.show("修改移动限价成功")})}else a.lightMsg.show("限价不能为空，必须为0.05元~99.99元之间");return!1}),d(".edit_mobdiscount").off("click.Table").on("click.Table",function(){var t=d("#adg_mobdiscount"),i=t.text(),a=d("#campaign_id").val(),o=d("#adgroup_id").val();e(["jl6/site_media/service/edit_mobdiscount/edit_mobdiscount"],function(e){e.show({value:i,obj:t,campaign_id:a,adgroup_id:o})})}),d("#reset_show_cloumn").off("click.Table").on("click.Table",function(){var e=[],i=[];for(var o in t.config.hideColumn)i.push(t.COLUM_DICT[t.config.hideColumn[o]]),e.push(t.config.hideColumn[o]);t.setHideCloumn(i),a.sendAjax.ajax("save_custom_column",{column:e},null)});var i=function(e,i){a.loading.show("正在提交"),a.sendAjax.ajax("submit_keyword_optimize",{submit_list:d.toJSON(e),update_mnt_list:d.toJSON(i),campaign_id:d("#campaign_id").val(),optm_type:0,mnt_type:d("#mnt_type").val()},function(e){var i=e.del_kw.length,o=e.update_kw.length,n=e.failed_kw.length,r=e.top_del_kw.length,s=e.mnt_change_kw.length,c=d.merge(e.top_del_kw,e.del_kw),l=d.merge(e.update_kw,e.mnt_change_kw),p="修改成功:"+o+"个，删除成功:"+i+"个";s&&(p+="，其中优化方式修改成功："+s+"个"),r&&(p+="，其中"+r+"个关键词已在淘宝被删除！"),n&&(p+="，操作失败:"+n+"个");for(var h=0;h<c.length;h++)t.delete_row(c[h]);for(var u=0;u<l.length;u++)t.update_row(l[u]);t.calcChangeNum();var m=parseInt(d(".keywords_count:first").text());d(".keywords_count").text(m-c.length),a.alert.show({body:p}),t.startWeirdClass(),d.isEmptyObject(t.rowCache)&&(d("#keyword_no_data").addClass("active").show(),d("#operation_bar").addClass("hide"),t.options.element.hide().removeClass("active"),t.fixHeader.fnGetSettings().aoCache[0].nWrapper.remove())}),a.loading.hide()};d("#submit_keywords").off("click.Table").on("click.Table",function(){var e=[],o=[],n=0,r=0;for(var s in t.rowCache){var c=t.rowCache[s];(c.del||c.up||c.down||c.mobileUp||c.mobileDown||c.match&&c.match!=c.data.match)&&(c.limit&&n++,c.mobileLimit&&r++,e.push({keyword_id:c.keywordId,adgroup_id:c.adgroupId,campaign_id:c.campaignId,word:c.word,new_price:Number(c.newPriceInput.val()),max_price:Number(c.maxPrice),max_mobile_price:Number(c.newMobilePriceInput.val()),mobile_old_price:Number(c.maxMobilePrice),mobile_is_default_price:0,match_scope:c.match,is_del:c.del})),c.mnt!=c.data.mnt&&o.push({keyword_id:c.keywordId,adgroup_id:c.adgroupId,mnt_opt_type:c.mnt})}if(e.length>0||o.length>0){var l="即将提交：",p=parseInt(d("#up_num").text()),h=parseInt(d("#down_num").text()),u=parseInt(d("#del_num").text()),m=parseInt(d("#match_num").text()),f=parseInt(d("#mnt_num").text()),b=parseInt(d("#up_mobile_num").text()),_=parseInt(d("#down_mobile_num").text());p&&(l+="PC加价"+p+"个，"),h&&(l+="PC降价"+h+"个，"),b&&(l+="移动加价"+b+"个，"),_&&(l+="移动降价"+_+"个，"),u&&(l+="删除"+u+"个，"),m&&(l+="修改匹配方式"+m+"个，"),f&&(l+="修改全自动优化类型"+f+"个，"),n&&(l+="有"+n+"个关键词超出了PC限价"+t.options.warnPrice+"元！"),r&&(l+="有"+r+"个关键词超出了移动限价"+t.options.mobileWarnPrice+"元！"),l+="亲，确定提交到直通车吗？",a.confirm.show({body:l,okHidden:function(){i(e,o)}})}else a.lightMsg.show("没有关键词改变，请进行操作")}),d("#filter_label").off(d.support.transition.end).on(d.support.transition.end,function(e){e.elapsedTime<.1||(t.fixHeader.fnUpdate(),d(".fixedHeader").show())}),d("#search_type").off("change").on("change",function(e,t){m=t})},w.prototype.checkedRow=function(){var e=[];return this.table.find("tbody tr:not(.unsort)").each(function(){var t=d(this).find("td.check_column input");t[0].checked&&e.push(d(this))}),e},w.prototype.getLabelCodeList=function(){var e,t=[];return d("#filter_warp li").each(function(){e=[],d("input:checked",this).length&&(d("input:checked",this).each(function(){e.push(this.value)}),t.push(e))}),t},w.prototype.getCustomLabelCodeList=function(){var e=[];return d("#filter_warp li").each(function(){var t,i,a=d(this);t=Number(a.find("input[type=text]:eq(0)").val()),i=Number(a.find("input[type=text]:eq(1)").val()),(t||i)&&e.push([a.attr("data-id").replace("refine_",""),t,i])}),e},w.prototype.showFilterLabel=function(e,t){for(var i="",a=d("#filter_label"),o={max_price:"PC当前出价",max_mobile_price:"移动当前出价",ctr:"点击率",click:"点击量",cpc:"花费",roi:"ROI",qscore:"PC质量分",wireless_qscore:"移动质量分"},n=0,r=e.length;r>n;n++){for(var s=d("#filter_warp input[type=checkbox][value="+e[n][0]+"]").data().title,c="",l=0,p=e[n].length;p>l;l++)c+=d("#filter_warp input[type=checkbox][value="+e[n][l]+"]").data().status+"，";i+='<li class="select"><a href="javascript:;">'+s+"："+c.slice(0,-1)+'<i data-value="'+e[n]+'"></i></a></li>'}for(var h=0,u=t.length;u>h;h++)i+=t[h][1]&&t[h][2]?'<li class="select"><a href="javascript:;">'+o[t[h][0]]+":"+t[h][1]+"~"+t[h][2]+'<i data-value="'+t[h][0]+'"></i></a></li>':t[h][1]?'<li class="select"><a href="javascript:;">'+o[t[h][0]]+":大于"+t[h][1]+'<i data-value="'+t[h][0]+'"></i></a></li>':'<li class="select"><a href="javascript:;">'+o[t[h][0]]+":小于"+t[h][2]+'<i data-value="'+t[h][0]+'"></i></a></li>';a.html(i),""!=i?a.addClass("active"):a.removeClass("active"),d(".fixedHeader").hide()},w.prototype.filterKwList=function(){var e=this;setTimeout(function(){var t,i,a;if(t=e.getLabelCodeList(),i=e.getCustomLabelCodeList(),a=e.table.find("tbody tr:not(.unsort)"),t.length||i.length)for(var o=0,n=a.length;n>o;o++){for(var r=0,s=e.rowCache[a[o].id],c=s.data.labelCode,l=0,d=t.length;d>l;l++){for(var h=0,u=0,m=t[l].length;m>u;u++)if(-1!=c.indexOf(t[l][u])){h=1;break}if(!h)break}for(var f=0,b=i.length;b>f;f++){var _,w=0,v=i[f][0];if(_=parseFloat(s.data[v]),isNaN(_))w=0;else if(w=i[f][1]&&i[f][2]&&(_<i[f][1]||_>i[f][2])?0:i[f][1]&&_<i[f][1]||i[f][2]&&_>i[f][2]?0:1,0==w)break}r=void 0===h?w:void 0===w?h:w&&h,r?s.setRowUp(!0):s.setRowDown(!1)}else e.table.find("[type=checkbox]").attr("checked",!1);p||e.table.fnSort([[1,"desc"]]),e.showFilterLabel(t,i),e.setChecked()},17)},w.prototype.changePrice8custom=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=Number(o.find(".radio:eq(0) input[type=text]").val());if(b(n)){for(var r=0,s=e.length;s>r;r++)this.rowCache[e[r][0].id].bulkPlus("custom",n,null,null,t,i);o.removeClass("open"),o.find(".radio:eq(0) input[type=text]").val("")}else a.lightMsg.show("自定义出价不合法，必须为0.05-99.99")},w.prototype.changePrice8yuanDown=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=Number(o.find(".radio:eq(2) input[type=text]").val());if(isNaN(n))a.lightMsg.show("根据调价金额降价的出价不合法");else{for(var r=0,s=e.length;s>r;r++){var c=this.rowCache[e[r][0].id];c.fallPlus("max_price",1==i?c.maxPrice:c.maxMobilePrice,n,"int",t,i)}o.removeClass("open")}},w.prototype.changePrice8parcentDown=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=Number(o.find(".radio:eq(3) input[type=text]").val());if(isNaN(n))a.lightMsg.show("根据调价金额降价的幅度不合法");else{for(var r=0,s=e.length;s>r;r++){var c=this.rowCache[e[r][0].id];c.fallPlus("max_price",1==i?c.maxPrice:c.maxMobilePrice,n,"parcent",t,i)}o.removeClass("open")}},w.prototype.changePrice8yuanUp=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=Number(o.find(".radio:eq(4) input[type=text]").val());if(isNaN(n))a.lightMsg.show("根据调价金额加价的出价不合法");else{for(var r=0,s=e.length;s>r;r++){var c=this.rowCache[e[r][0].id];c.bulkPlus("max_price",1==i?c.maxPrice:c.maxMobilePrice,n,"int",t,i)}o.removeClass("open")}},w.prototype.changePrice8parcentUp=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=Number(o.find(".radio:eq(5) input[type=text]").val());if(isNaN(n))a.lightMsg.show("根据调价金额加价的幅度不合法");else{for(var r=0,s=e.length;s>r;r++){var c=this.rowCache[e[r][0].id];c.bulkPlus("max_price",1==i?c.maxPrice:c.maxMobilePrice,n,"parcent",t,i)}o.removeClass("open")}},w.prototype.changePrice8gPrice=function(e,t,i){var o=d(1==i?"#price_warp":"#mobile_price_warp"),n=o.find(".radio:eq(1) select").val();if(!d.isNumeric(n))return a.lightMsg.show("请选择出价幅度"),!1;for(var r=0,s=e.length;s>r;r++){var c=this.rowCache[e[r][0].id];c.bulkPlus("g_cpc",c.data.g_cpc,Number(n)-100,"parcent",t,i)}o.removeClass("open")},w.prototype.setChecked=function(){var e=this;this.table.find("tbody tr:not(.unsort)").each(function(){var t=d(this).find("td.check_column input"),i=e.rowCache[d(this).attr("id")];i.checked=t[0].checked?!0:!1}),this.calcChangeNum()},w.prototype.calcChangeNum=function(){var e=0,t=0,i=0,a=0,o=0,n=0,r=0,s=0;for(var c in this.rowCache){var l=this.rowCache[c];l.checked&&e++,l.del?a++:(l.up&&t++,l.down&&i++,l.mobileUp&&r++,l.mobileDown&&s++,l.match&&l.match!=l.data.match&&o++,l.mnt!=l.data.mnt&&n++)}d("#checked_num").text(e),d("#up_num").text(t),d("#down_num").text(i),d("#del_num").text(a),d("#match_num").text(o),d("#mnt_num").text(n),d("#up_mobile_num").text(r),d("#down_mobile_num").text(s)},w.prototype.getHideColumn=function(){for(var e=[],t=this.table.fnSettings().aoColumns,i=0,a=t.length;a>i;i++)if(!t[i].bVisible)for(var o in this.COLUM_DICT)this.COLUM_DICT[o]==i&&e.push(o);return e},w.prototype.setHideCloumn=function(e){for(var t=this.table.fnSettings().aoColumns,i=1,a=t.length;a>i;i++)-1!=e.indexOf(i)&&this.table.fnSetColumnVis(i,!1),t[i].bVisible||-1!=e.indexOf(i)||this.table.fnSetColumnVis(i,!0);this.fixTableWidth(),this.startWeirdClass()},w.prototype.delete_row=function(e){this.table.fnDeleteRow(this.table.fnGetPosition(this.rowCache[e].nRow)),delete this.rowCache[e]},w.prototype.update_row=function(e){var t=this.rowCache[e],i=Number(t.newPriceInput.val()),a=Number(t.newMobilePriceInput.val());t.data.match=t.match,t.data.mnt=t.mnt,t.maxPrice!=i&&(t.maxPrice=i,t.data.max_price=i),d("#"+e).find(".max_price").html('<span class="hide">'+i.toFixed(2)+"</span>"+i.toFixed(2)),t.maxMobilePrice!=a&&(t.maxMobilePrice=a,t.data.max_mobile_price=a),d("#"+e).find(".max_mobile_price").html('<span class="hide">'+a.toFixed(2)+"</span>"+a.toFixed(2)),t.updateStyle()},w.prototype.startWeirdClass=function(){if(this.table&&p){this.table.find("tbody>tr.weird").remove();for(var e in this.options.classDict){var t=d("tr["+this.options.classBase+"= "+e+"]",this.table);t.first().before('<tr class="noSearch weird unsort" style="background-color: aliceblue;"> <td class="all"><input class="kid_box" type="checkbox" rule="'+e+'"> </td> <td colspan="'+(this.table.find("th").length-2)+'" class="tl b poi" rule="'+e+'"><span class="iconfont">&#xe603;</span>'+this.options.classDict[e][2]+"<span>("+t.length+"个)</span> </td> </tr>")}this.bingWeirdChecked(),this.toggleWeird(),this.checkCallback(),p=!0}},w.prototype.closeWeirdClass=function(){d("#weird_switch").removeClass("on"),d("#select_class").trigger("choose.data-select",["0"]),this.table.find("tbody>tr.weird").remove(),this.table.find("tbody>tr").removeClass("hidden"),this.checkCallback(),p=!1},w.prototype.bingWeirdChecked=function(){var e=this;this.table.find("tr.weird .all").on("click",function(t){var i=d(this).find("input"),a=i.attr("rule");e.table.find("tr["+e.options.classBase+"="+a+"]>td>input[type=checkbox]").each(function(){this.checked=i[0].checked}),e.checkCallback(),t.stopPropagation()})},w.prototype.toggleWeird=function(){var e=this;this.table.find("tr.weird .poi").on("click",function(){var t=d(this).attr("rule"),i=e.table.find("tr["+e.options.classBase+'="'+t+'"]').toggleClass("hidden");d(this).find(".iconfont").html(i.first().hasClass("hidden")?"&#xe630;":"&#xe603;")})},w.prototype.searchWordAndSort=function(e){var t=this,i=!1;for(var o in this.rowCache){var n=this.rowCache[o],r=d.trim(d(n.nRow).find(".word").text());m?r==e?(n.setRowUp(!0),i=!0):n.setRowDown(!1):-1!=r.indexOf(e)?(n.setRowUp(!0),i=!0):n.setRowDown(!1)}i||a.lightMsg.show("没有符合条件的关键词"),p&&t.closeWeirdClass(),this.table.fnSort([[1,"desc"]]),this.setChecked()},w.prototype.generateCsvData=function(e){for(var t=["关键词","PC当前出价","移动当前出价","养词天数","展现量","点击量","点击率","总花费","平均点击花费","千次点击花费","昨日平均排名","收藏量","店铺收藏量","宝贝收藏量","收藏率","收藏成本","购物车总数","成交量","直接成交量","间接成交量","成交额","直接成交额","间接成交额","转化率","投资回报","全网展现指数","全网点击指数","全网点击率","全网点转化率","全网点ROI","全网市场均价","全网竞争度","全网成交指数","计算机质量得分","移动质量得分"],i=["word","max_price","max_mobile_price","create_days","impr","click","ctr","cost","cpc","cpm","avgpos","favcount","favshopcount","favitemcount","favctr","favpay","carttotal","paycount","directpaycount","indirectpaycount","pay","directpay","indirectpay","conv","roi","g_pv","g_click","g_ctr","g_coverage","g_roi","g_cpc","g_competition","g_paycount"],a="",o=0,n=e.length;n>o;o++){for(var r=0,s=i.length;s>r;r++)a+=(e[o][i[r]]||0)+"	";a+=(e[o].qscore_dict.qscore||0)+"	",a+=(e[o].qscore_dict.wireless_qscore||0)+"	",a+="\n"}this.exportCsvStr=t.join("	")+"\n"+a},w.prototype.getCsvData=function(){return this.exportCsvStr},w.prototype.getAdgroupTitle=function(){return d("#adgroup_title").val()},w.prototype.getweirdSwitch=function(){return p},w.prototype.setWeirdSwitch=function(e){p=e},w.prototype.checkCallback=function(){var e=this,t=this.options.element.find("tbody>tr>td"),i=[];if(p)for(var a in this.options.classDict){i.push(a);var o=e.options.element.find("tbody>tr["+e.options.classBase+"="+a+"]>td");o.find("input[type=checkbox]").length==o.find("input[type=checkbox]:checked").length?e.options.element.find("input[rule="+a+"]").length&&(e.options.element.find("input[rule="+a+"]")[0].checked=!0):e.options.element.find("input[rule="+a+"]").length&&(e.options.element.find("input[rule="+a+"]")[0].checked=!1)}t.find("input[type=checkbox]").length==t.find("input[type=checkbox]:checked").length?(d(".fixedHeader .all>input")[0].checked=!0,this.options.element.find("thead .all>input")[0].checked=!0):(d(".fixedHeader .all>input")[0].checked=!1,this.options.element.find("thead .all>input")[0].checked=!1),setTimeout(function(){e.setChecked()},17)},w.prototype.setSortfalg=function(){for(var e in this.rowCache){var t=this.rowCache[e].nRow,i=t.getAttribute(this.options.classBase);t.setAttribute("data-weird-desc",this.options.classDict[i][0]),t.setAttribute("data-weird-asc",this.options.classDict[i][1])}},w.prototype.fixTableWidth=function(){var e=0,t=document.body.offsetWidth-62;this.options.element.find("thead>tr>th").each(function(){e+=Number(this.className.match(/w(\d+)/)[1])}),e>t?this.options.element.removeClass("auto-width"):this.options.element.addClass("auto-width")},{filter:f,Table:w,Row:_}});