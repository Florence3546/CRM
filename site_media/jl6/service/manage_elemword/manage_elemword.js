define("jl6/site_media/service/manage_elemword/manage_elemword",["jl6/site_media/widget/alert/alert","jl6/site_media/widget/confirm/confirm","jl6/site_media/widget/loading/loading","jl6/site_media/widget/ajax/ajax","jl6/site_media/widget/tagEditor/tagEditor"],function(d,a,r,o,t){var i,e,_=0,l=0,s=$("#campaign_id").val(),n=function(){$(document).on("click",".open_manage_elemword",function(){$("#div_manage_elemword").modal();var a=$(this).data("init_data");if(void 0===a){if(_=$(this).attr("id").split("_")[2],l=$(this).attr("adg_id"),void 0===Number(_))return void d.show({backdrop:!1,body:"请刷新页面重试"});o.ajax("manage_elemword",{item_id:_},n)}else{_=$(this).attr("id").split("_")[2],l=$(this).attr("adg_id");for(var r=a.prdtword,t=i.getTags(),e=0;e<t.length;e++)r.indexOf(t[e])<0&&i.removeTag(t[e])}});var n=function(d){var a=d.data;$("#manage_elemword_"+_).data("init_data",a);var r=a.prdtword.split(",");$("#old_m_prdtword").val(a.prdtword);var o={placeholder:"输入产品词，回车确定",initialTags:r,onChange:function(d,a,r){var o=$("#old_m_prdtword").val(),t=r;t.toString()==o?$("#save_m_prdtword").addClass("disabled"):$("#save_m_prdtword").removeClass("disabled")}};i=t.tagEditor($("#m_prdtword"),o),$("#old_m_blackword").val(a.blackword),r=a.blackword.split(",");var l={placeholder:"输入屏蔽词，回车确定",initialTags:r,onChange:function(d,a,r){var o=$("#old_m_blackword").val(),t=r;t.toString()==o?$("#save_m_blackword").addClass("disabled"):$("#save_m_blackword").removeClass("disabled")}};e=t.tagEditor($("#m_blackword"),l)};$("#save_m_prdtword").click(function(){var a=$("#old_m_prdtword").val(),t=i.getTags();if(t.toString()==a)return d.show({backdrop:!1,body:"您还未做出任何修改！"}),!1;var e={prdtword:t};m(e),r.show("正在保存产品词"),o.ajax("save_prdtword",{item_id:_,adgroup_id:l,campaign_id:s,prdtword:t.toString()},function(a){r.hide(),1==a.result&&(d.show({backdrop:!1,body:"保存成功！"}),$("#old_m_prdtword").val(t.toString()),$("#save_m_prdtword").addClass("disabled"))})}),$("#restore_elemword_ps").click(function(){r.show("正在恢复默认值"),o.ajax("restore_elemword",{item_id:_},function(a){if(1==a.result){r.hide(),d.show({backdrop:!1,body:"恢复成功！"}),$("#m_prdtword").tagEditor("destroy"),$("#old_m_prdtword").val(a.prdtword_data_str);var o={placeholder:"输入产品词，回车确定",initialTags:a.prdtword_data_str.split(","),onChange:function(d,a,r){var o=$("#old_m_prdtword").val(),t=r;t.toString()==o?$("#save_m_prdtword").addClass("disabled"):$("#save_m_prdtword").removeClass("disabled")}};i=t.tagEditor($("#m_prdtword"),o),w({prdtword:a.prdtword_data_str}),$("#save_m_prdtword").addClass("disabled")}})}),$("#save_m_blackword").click(function(){var t=$("#old_m_blackword").val(),i=e.getTags();return i.toString()==t?(d.show({backdrop:!1,body:"您还未做出任何修改！"}),!1):void a.show({body:"注意：如果宝贝在其他计划下推广，包含屏蔽词的关键词也会被删除，确定要删除吗？",backdrop:!1,okHidden:function(){var a={blackword:i};m(a),r.show("正在保存屏蔽词"),o.ajax("save_bword",{item_id:_,campaign_id:s,adgroup_id:l,save_or_update:0,common_table_flag:$("#common_table").length,blackwords:i.toString()},function(a){return r.hide(),a.result?($("#old_m_blackword").val(i.toString()),d.show({backdrop:!1,body:"保存成功！"}),void $("#save_m_blackword").addClass("disabled")):(d.show({backdrop:!1,body:a.error_msg}),!1)})}})})},m=function(d){var a=$("#manage_elemword_"+_),r=a.data("init_data");for(var o in d)r[o]=d[o];a.data("modifed_data",r)},w=function(d){void 0!==d&&m(d);var a=$("#manage_elemword_"+_),r=a.data("modifed_data");a.data("init_data",r)};return{init:n}});