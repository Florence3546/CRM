define("jl6/site_media/service/op_history/op_history",["require","jl6/site_media/plugins/moment/moment.min","jl6/site_media/service/common/common","jl6/site_media/service/op_history/op_row","jl6/site_media/plugins/artTemplate/template","jl6/site_media/plugins/data-tables/dataTableExt","jl6/site_media/widget/ajax/ajax"],function(require,moment,common,op_row,template,dataTable,ajax){"use strict";function GetUrlParam(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(e);return null!=a?unescape(a[2]):null}function ChangeUrlArg(url,arg,arg_val){var pattern=arg+"=([^&]*)",replaceText=arg+"="+arg_val;if(url.match(pattern)){var tmp="/("+arg+"=)([^&]*)/gi";return tmp=url.replace(eval(tmp),replaceText)}return url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText}var obj={camp_id:-1,op_type:-1,opter:-1,start_date:moment().subtract(2,"days").format("YYYY-MM-DD"),end_date:moment().subtract(0,"days").format("YYYY-MM-DD"),pageIdx:1,search_word:""},init=function(){bindEvent(),op_row.init(obj),setTimeout(delaySign,2e3)},delaySign=function(){$(".width100").animate({width:24},1e3,function(){$(".width100").removeAttr("style"),$(".width100").removeClass("width100"),$(".sign-left>a").addClass("sign-content")})},initSelect=function(){var t=GetUrlParam("camp_id");t&&(obj.camp_id=t),ajax.ajax("get_camp_list",{},function(t){var e="";$.each(t.camp_list,function(t,a){a.camp_id==obj.camp_id?($("#select_camp .tip").text(a.camp_title),e+='<li data-value="'+a.camp_id+'"><span class="active">'+a.camp_title+"</span></li>"):e+='<li data-value="'+a.camp_id+'"><span>'+a.camp_title+"</span></li>"}),$("#select_camp").find("ul").html(e)})},bindEvent=function(){$("#select_camp").on("change",function(t,e){obj.camp_id=e,op_row.init(obj)}),$("#select_optype").on("change",function(t,e){obj.op_type=e,op_row.init(obj)}),$("#select_opter").on("change",function(t,e){obj.opter=e,op_row.init(obj)}),$("#select_days").on("change",function(){obj.start_date=moment($(this).daterangepicker("getRange").start).format("YYYY-MM-DD"),obj.end_date=moment($(this).daterangepicker("getRange").end).format("YYYY-MM-DD"),op_row.init(obj)}),$("#search_btn").click(function(){var t=$.trim($("#search_val").val());obj.search_word=t,op_row.init(obj)}),$("#search_val").keyup(function(t){if(13==t.keyCode){var e=$.trim($("#search_val").val());obj.search_word=e,op_row.init(obj)}}),$("#op_table").on("click",".btnx",function(){$(".his_item").removeClass("open")})};return{init:init}});