define("jl6/site_media/service/op_history/op_row",["require","jl6/site_media/plugins/artTemplate/template","jl6/site_media/service/page_tool/page_tool","jl6/site_media/widget/ajax/ajax"],function(t,e,i,n){"use strict";var a,l=function(t){a=t,o(t)},o=function(t){n.ajax("get_history_list",t,p)},s=function(t){a.pageIdx=t,o(a)},d=function(t){var e=288,i=180;$(t).find(".sub_div div").each(function(t,e){var n=$.trim($(e).text().replace(/\s*/g,"")).replace(",","").replace(".","").replace(":","").replace(";","").replace("，","").replace("。","").replace("：","").replace(";","").replace('"',"").replace("'",""),a=14*n.length+20;a>i&&(i=a)}),i>800&&(i=800),$(t).find(".sub_div").css("width",i);var n=$(window).width(),a=$(window).height(),l=$(document).scrollTop(),o=$(document).scrollLeft(),s=t.position(),d=s.left-o,p=s.top-l,r=d+i,c=p+e,_=n-r,f=a-c,u=a-p,g=new Object;g.top=p+l,g.left=d+o,0>_&&(g.left=d-i+o),0>f&&(g.top=p-e+l),0>u&&(g.top=p+e+l),$(t).find(".dropdown-menu").offset(g)},p=function(t){for(var n="",a='<tr>\n    <td>{{list.opt_time}}</td>\n    <td>{{list.opter}}</td>\n    <td>{{list.op_type}}</td>\n    <td>{{list.data_type}}</td>\n    <td>\n        {{list.detail_list[0]}}\n        {{ if list.detail_length > 1 }}\n            <span class="dropdown his_item">\n                <a href="javascript:;" data-toggle="dropdown" >\n                    <span class="dropdown-value">查看明细>></span>\n                </a>\n                <div class="dropdown-menu hold-on-click">\n                    <div class="modal-header">\n                        <button type="button" class="close btnx" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                        <h5 class="modal-title">操作记录明细</h5>\n                    </div>\n                    <div class="sub_div">\n                    {{ each list.detail_list }}\n                    {{ if $index > 0}}<div>{{ $value }}</div>{{ /if }}\n                    {{ /each }}\n                    </div>\n                </div>\n            </span>\n        {{ /if }}\n    </td>\n</tr>\n\n',l=0,o=t.history_list.length;o>l;l++)n+=e.compile(a)({list:t.history_list[l]});""==$.trim(n)&&(n="<tr><td colspan='5' class='tc'>对不起，查询不到相关数据！</td></tr>"),$("#op_table tbody").html($.trim(n));var p={page_row:t.page_info.page,page_list:t.page_info.page_xrange,page_count:t.page_info.page_count,page_size:100};i.init(p,s),$(".his_item").on("shown.bs.dropdown",function(){d($(this))})};return{init:l,getPageData:s}});