define("jl6/site_media/service/report_detail/report_detail",["require","jl6/site_media/plugins/artTemplate/template","jl6/site_media/plugins/moment/moment.min","jl6/site_media/service/common/common","jl6/site_media/widget/dtrPicker/dtrPicker","jl6/site_media/widget/ajax/ajax","jl6/site_media/widget/loading/loading","jl6/site_media/widget/alert/alert"],function(t,a,e,d,n,i,l){"use strict";var o=function(){$("#show_rpt_subdivide_all").off("click"),$("#show_rpt_subdivide_all").on("click",function(){var t=$(this).data("is_showing");t?($(this).parents("table:first").find(".show_subdivide.in").trigger("click"),delete $(this).data().is_showing):($(this).parents("table:first").find(".show_subdivide:not(.in)").trigger("click"),$(this).data("is_showing",1)),c()})},r=function(t,e,n,r,s,c,h,p){l.show("数据加载中，请稍候..."),i.ajax("get_rpt_detail",{start_date:t,end_date:e,type:n,shop_id:r,campaign_id:s,adgroup_id:c,creative_id:h,keyword_id:p,source:$("#data_source button.active").length?$("#data_source button.active").data().source:"all"},function(t){l.hide();var e,n;switch(t.data.tpl_type){case 0:e='<div id="chart_report_detail" class="pct100" style="height:200px; width: 1068px;"></div>\n<div style="height:400px;overflow-y:auto;">\n	<table id="table_report_detail" class="table table-bordered icon_hover_show table-hover">\n	    <thead>\n            <tr class="fixed_tr">\n                <th width="w90">日期<a id="show_rpt_subdivide_all" class="r base_color" href="javascript:;"><i class="iconfont mr5">&#xe640;</i>细分</a></th>\n                <th>展现量</th>\n                <th>点击量</th>\n                <th>点击率</th>\n                <th>PPC<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="平均点击花费">&#xe61a;</i></th>\n                <th>总花费</th>\n                <th>成交额</th>\n                <th>成交量</th>\n                <th>收藏量</th>\n                <th>ROI<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="投资回报率">&#xe61a;</i></th>\n                <th>转化率</th>\n                <th>购物车总数</th>\n                <th>成交量单价&nbsp;<i class="iconfont f14" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="成交量单价 = 成交额/成交量">&#xe61a;</i></th>\n            </tr>\n            <tr class="inner_tr">\n                <th width="w90">日期<a id="show_rpt_subdivide_all" class="r base_color" href="javascript:;"><i class="iconfont mr5">&#xe640;</i>细分</a></th>\n                <th>展现量</th>\n                <th>点击量</th>\n                <th>点击率</th>\n                <th>PPC<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="平均点击花费">&#xe61a;</i></th>\n                <th>总花费</th>\n                <th>成交额</th>\n                <th>成交量</th>\n                <th>收藏量</th>\n                <th>ROI<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="投资回报率">&#xe61a;</i></th>\n                <th>转化率</th>\n                <th>购物车总数</th>\n                <th>成交量单价&nbsp;<i class="iconfont f14" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="成交量单价 = 成交额/成交量">&#xe61a;</i></th>\n            </tr>\n	    </thead>\n	    <tbody style="height:400px;overflow-y:scroll;">\n	        {{ if rpt_list.length }}\n	        {{each rpt_list}}\n	        <tr>\n	            <td>{{$value.date}}<i class="iconfont show_subdivide r">&#xe60a;</i></td>\n	            <td>{{$value.summed.impr}}</td>\n	            <td>{{$value.summed.click}}</td>\n	            <td>{{$value.summed.ctr}}%</td>\n	            <td>{{$value.summed.cpc}}</td>\n	            <td>{{$value.summed.cost}}</td>\n	            <td>{{$value.summed.pay}}</td>\n	            <td>{{$value.summed.paycount}}</td>\n	            <td>{{$value.summed.favcount}}</td>\n	            <td>{{$value.summed.roi}}</td>\n	            <td>{{$value.summed.conv}}%</td>\n	            <td>{{$value.summed.carttotal}}</td>\n	            <td>{{$value.summed.avg_pay}}</td>\n	        </tr>\n	        <tr class="hover_non_color hidden">\n	            <td class="tr">计算机 - 站内</td>\n	            {{ if $value.pcin }}\n	            <td>{{$value.pcin.impr}}</td>\n	            <td>{{$value.pcin.click}}</td>\n	            <td>{{$value.pcin.ctr}}%</td>\n	            <td>{{$value.pcin.cpc}}</td>\n	            <td>{{$value.pcin.cost}}</td>\n	            <td>{{$value.pcin.pay}}</td>\n	            <td>{{$value.pcin.paycount}}</td>\n	            <td>{{$value.pcin.favcount}}</td>\n	            <td>{{$value.pcin.roi}}</td>\n	            <td>{{$value.pcin.conv}}%</td>\n	            <td>{{$value.pcin.carttotal}}</td>\n	            <td>{{$value.pcin.avg_pay}}</td>\n	            {{ else }}\n	            <td class="tc item_base" colspan="12">暂无数据</td>\n	            {{ /if }}\n	        </tr>\n	        <tr class="hover_non_color hidden">\n	           <td class="tr">计算机 - 站外</td>\n	            {{ if $value.pcout }}\n	            <td>{{$value.pcout.impr}}</td>\n	            <td>{{$value.pcout.click}}</td>\n	            <td>{{$value.pcout.ctr}}%</td>\n	            <td>{{$value.pcout.cpc}}</td>\n	            <td>{{$value.pcout.cost}}</td>\n	            <td>{{$value.pcout.pay}}</td>\n	            <td>{{$value.pcout.paycount}}</td>\n	            <td>{{$value.pcout.favcount}}</td>\n	            <td>{{$value.pcout.roi}}</td>\n	            <td>{{$value.pcout.conv}}%</td>\n	            <td>{{$value.pcout.carttotal}}</td>\n	            <td>{{$value.pcout.avg_pay}}</td>\n	            {{ else }}\n	            <td class="tc item_base" colspan="12">暂无数据</td>\n	            {{ /if }}\n	        </tr>\n	        <tr class="hover_non_color hidden">\n	            <td class="tr">移动 - 站内</td>\n	            {{ if $value.ydin }}\n	            <td>{{$value.ydin.impr}}</td>\n	            <td>{{$value.ydin.click}}</td>\n	            <td>{{$value.ydin.ctr}}%</td>\n	            <td>{{$value.ydin.cpc}}</td>\n	            <td>{{$value.ydin.cost}}</td>\n	            <td>{{$value.ydin.pay}}</td>\n	            <td>{{$value.ydin.paycount}}</td>\n	            <td>{{$value.ydin.favcount}}</td>\n	            <td>{{$value.ydin.roi}}</td>\n	            <td>{{$value.ydin.conv}}%</td>\n	            <td>{{$value.ydin.carttotal}}</td>\n	            <td>{{$value.ydin.avg_pay}}</td>\n	            {{ else }}\n	            <td class="tc item_base" colspan="12">暂无数据</td>\n	            {{ /if }}\n	        </tr>\n	        <tr class="hover_non_color hidden">\n	            <td class="tr">移动 - 站外</td>\n	            {{ if $value.ydout }}\n	            <td>{{$value.ydout.impr}}</td>\n	            <td>{{$value.ydout.click}}</td>\n	            <td>{{$value.ydout.ctr}}%</td>\n	            <td>{{$value.ydout.cpc}}</td>\n	            <td>{{$value.ydout.cost}}</td>\n	            <td>{{$value.ydout.pay}}</td>\n	            <td>{{$value.ydout.paycount}}</td>\n	            <td>{{$value.ydout.favcount}}</td>\n	            <td>{{$value.ydout.roi}}</td>\n	            <td>{{$value.ydout.conv}}%</td>\n	            <td>{{$value.ydout.carttotal}}</td>\n	            <td>{{$value.ydout.avg_pay}}</td>\n	            {{ else }}\n	            <td class="tc item_base" colspan="12">暂无数据</td>\n	            {{ /if }}\n	        </tr>\n	        {{/each}}\n	        {{ else }}\n	        <tr>\n	            <td class="tc item_base" colspan="13">暂无数据</td>\n	        </tr>\n	        {{ /if }}\n	    </tbody>\n	</table>\n</div>\n';break;case 1:e='<div id="chart_report_detail" class="pct100" style="height:200px; width: 1068px;"></div>\n<div style="height:400px;overflow-y:auto;">\n    <table id="table_report_detail" class="table table-bordered">\n        <thead>\n            <tr class="fixed_tr">\n                <th>日期</th>\n                <th>展现量</th>\n                <th>点击量</th>\n                <th>点击率</th>\n                <th>PPC<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="平均点击花费">&#xe61a;</i></th>\n                <th>总花费</th>\n                <th>成交额</th>\n                <th>成交量</th>\n                <th>收藏量</th>\n                <th>ROI<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="投资回报率">&#xe61a;</i></th>\n                <th>转化率</th>\n                <th>购物车总数</th>\n                <th>成交量单价&nbsp;<i class="iconfont f14" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="成交量单价 = 成交额/成交量">&#xe61a;</i></th>\n            </tr>\n            <tr class="inner_tr">\n                <th>日期</th>\n                <th>展现量</th>\n                <th>点击量</th>\n                <th>点击率</th>\n                <th>PPC<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="平均点击花费">&#xe61a;</i></th>\n                <th>总花费</th>\n                <th>成交额</th>\n                <th>成交量</th>\n                <th>收藏量</th>\n                <th>ROI<i class="iconfont ml2" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="投资回报率">&#xe61a;</i></th>\n                <th>转化率</th>\n                <th>购物车总数</th>\n                <th>成交量单价&nbsp;<i class="iconfont f14" data-toggle="tooltip" data-placement="top" data-trigger="hover" title="成交量单价 = 成交额/成交量">&#xe61a;</i></th>\n            </tr>\n        </thead>\n        <tbody style="height:400px;overflow-y:scroll;">\n            {{ if rpt_list.length }}\n            {{each rpt_list}}\n            <tr>\n                <td>{{$value.date}}</td>\n                <td>{{$value.summed.impr}}</td>\n                <td>{{$value.summed.click}}</td>\n                <td>{{$value.summed.ctr}}%</td>\n                <td>{{$value.summed.cpc}}</td>\n                <td>{{$value.summed.cost}}</td>\n                <td>{{$value.summed.pay}}</td>\n                <td>{{$value.summed.paycount}}</td>\n                <td>{{$value.summed.favcount}}</td>\n                <td>{{$value.summed.roi}}</td>\n                <td>{{$value.summed.conv}}%</td>\n                <td>{{$value.summed.carttotal}}</td>\n                <td>{{$value.summed.avg_pay}}</td>\n            </tr>\n            {{/each}}\n            {{ else }}\n            <tr>\n                <td class="tc item_base" colspan="13">暂无数据</td>\n            </tr>\n            {{ /if }}\n        </tbody>\n    </table>\n</div>\n'}n=a.compile(e)({rpt_list:t.data.rpt_list}),$("#table_report_detail").remove(),$("#modal_report_detail .modal-body").html(n),d.chart.draw("chart_report_detail",t.data.category_list,t.data.series_cfg_list),$("#table_report_detail [data-toggle=tooltip]").tooltip(),$("#table_report_detail tr.fixed_tr>th").each(function(t){$(this).width($("#table_report_detail tr.inner_tr>th:eq("+t+")").width())}),o()})},s=function(t,a,d,n,i,l,o){var r,s;r=e().subtract(7,"days").format("YYYY-MM-DD"),s=e().subtract(1,"days").format("YYYY-MM-DD"),d=d||"",n=n||"",i=i||"",l=l||"",o=o||"",$("#modal_report_detail .modal-title").html(t),$("#modal_report_detail").attr({type:a,shop_id:d,campaign_id:n,adgroup_id:i,creative_id:l,keyword_id:o}).modal(),$("#report_detail_days").daterangepicker("setRange",{start:e(r).toDate(),end:e(s).toDate()})},c=function(){$("#table_report_detail tr.fixed_tr>th").each(function(t){$(this).width($("#table_report_detail tr.inner_tr>th:eq("+t+")").width())})},h=function(t,a){if(0==$("#modal_report_detail").length){var d='<div class="modal fade" id="modal_report_detail">\n    <div class="modal-dialog modal-lger">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>\n                <span class="modal-title f18">报表明细</span>\n                <div class="dtr_picker_warp ml10">\n                    <span class="tip" id="report_detail_days">昨天</span>\n                </div>\n            </div>\n            <div class="modal-body">\n            </div>\n        </div>\n    </div>\n</div>';$("body").append(d),$("#modal_report_detail").on("shown.bs.modal",function(){$(this).find("[data-toggle=tooltip]").tooltip(),c()}),t=t?t:0,a=a?a:3,$("#report_detail_days").attr({rt_rpt:t,months:a}),n.init($("#report_detail_days"))}$("#report_detail_days").off("change"),$("#report_detail_days").on("change",function(){var t,a,d,n,i,l,o,s;t=e($(this).daterangepicker("getRange").start).format("YYYY-MM-DD"),a=e($(this).daterangepicker("getRange").end).format("YYYY-MM-DD"),d=$("#modal_report_detail").attr("type"),n=$("#modal_report_detail").attr("shop_id"),i=$("#modal_report_detail").attr("campaign_id"),l=$("#modal_report_detail").attr("adgroup_id"),o=$("#modal_report_detail").attr("creative_id"),s=$("#modal_report_detail").attr("keyword_id"),r(t,a,d,n,i,l,o,s)}),$("#modal_report_detail").off("click",".show_subdivide"),$("#modal_report_detail").on("click",".show_subdivide",function(){$(this).hasClass("in")?($(this).closest("tr").nextUntil("tr:not(.hover_non_color)").addClass("hidden"),$(this).removeClass("in")):($(this).closest("tr").nextUntil("tr:not(.hover_non_color)").removeClass("hidden"),$(this).addClass("in")),c()}),$("#modal_report_detail").on("hide.bs.modal",function(){$("#report_detail_days").daterangepicker("close")})};return{init:h,show:s}});