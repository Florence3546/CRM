define("jl6/site_media/service/rob_rank/rob_record",["jl6/site_media/plugins/artTemplate/template","jl6/site_media/widget/ajax/ajax","jl6/site_media/plugins/moment/moment.min"],function(t,e,a){"use strict";var i,i='<div class="modal fade drawer" id="rob_record">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                <h4 class="modal-title">抢排名记录</h4>\n                <div class="btn-group show_model mr10">\n                    <a class="btn btn-sm active" data-type="char_info"><i class="iconfont b">&#xe64a;</i></a>\n                    <a class="btn btn-sm" data-type="table_info"><i class="iconfont b">&#xe640;</i></a>\n                </div>                \n            </div>\n            <div class="modal-body">\n                <div class="drawer_body">\n                    <div class="tr mt10">\n                        <!--<div class="btn-group show_model mr10">\n                            <a class="btn btn-sm active" data-type="sign_char"><i class="iconfont b">&#xe64a;</i></a>\n                            <a class="btn btn-sm" data-type="sign_table"><i class="iconfont b">&#xe640;</i></a>\n                        </div>-->\n                    </div>\n                    <div id="sign_char" style="height:300px;"></div>\n                    <div id="sign_table" class="hide" style="height:280px;margin:10px;">\n                        <table class="table table-bordered">\n                            <thead>\n                                <tr>\n                                    <th>优化时间</th>\n                                    <th>出价</th>\n                                    <th>排名情况</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <tr>\n                                    <td colspan="3" class="tc">\n                                        正在获取，请稍后。。。\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                    <div class="pl10 pr10">\n                        <span>当前设置：<span class="setting">--</span></span>\n                        <button class="btn btn-primary r btn-sm close_drawer" type="button">返回</button>\n                    </div>\n                </div>\n                <div id="char_info" style="height:340px;"></div>\n                <div id="table_info" class="hide">\n                    <table class="table table-bordered">\n                        <thead>\n                            <tr>\n                                <th>优化时间</th>\n                                <th>出价</th>\n                                <th>排名情况</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <td colspan="3" class="tc">\n                                    正在获取，请稍后。。。\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>                    \n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',n=function(a){var n,d;n=t.compile(i)(a),d=$(n),$("body").append(d),d.modal({backdrop:"static"}),d.on("shown.bs.modal",function(){e.ajax("rob_record",{keyword_id:a.keywordId},function(t){s(t,a)})}),d.on("hidden.bs.modal",function(){$(this).remove()}),d.find(".show_model .btn").on("click",function(){var t=$(this).data().type;d.find(".show_model .btn").removeClass("active"),$(this).addClass("active"),$("#char_info,#table_info").addClass("hide"),$("#"+t).removeClass("hide")}),d.find(".close_drawer").on("click",function(){d.find(".drawer_body").removeClass("active")})},s=function(t,e){var i=[],n=[],s=[];if(t.data[e.keywordId].length)for(var d in t.data[e.keywordId].reverse()){var r=$.evalJSON(t.data[e.keywordId][d]);n.push(r),"ok"!=r.result_flag&&"nearly_ok"!=r.result_flag?"done"!=r.result_flag&&"failed"!=r.result_flag?s.push("<tr><td>"+r.rob_time+"</td><td>"+Number(r.price).toFixed(2)+"</td><td>"+r.msg+"</td></tr>"):(i.push({flag:"fail",time:r.rob_time,price:r.price,data:n,platform:r.platform,limit_price:r.limit_price,exp_rank_range:r.exp_rank_range,nearly_success:r.nearly_success,msg:n.length>1?n[1].msg:n[0].msg}),n=[],s.push("<tr><td>"+r.rob_time+"</td><td>"+Number(r.price).toFixed(2)+'</td><td><img src="/site_media/jl6/static/images/fail.png?t=1490089588990"/>'+r.msg+"</td></tr>")):(i.push({flag:"ok",time:r.rob_time,price:r.price,data:n,msg:r.msg,platform:r.platform,limit_price:r.limit_price,exp_rank_range:r.exp_rank_range,nearly_success:r.nearly_success}),n=[],s.push("<tr><td>"+r.rob_time+"</td><td>"+Number(r.price).toFixed(2)+'</td><td><img src="/site_media/jl6/static/images/success.png?t=1490089588990"/>'+r.msg+"</td></tr>"))}$("#char_info").highcharts({chart:{type:"spline"},title:{text:""},subtitle:{text:""},credits:{text:""},legend:{enabled:!1},xAxis:{categories:i.slice(-18).map(function(t){return a(t.time).format("MM-D H:mm")})},yAxis:[{title:{text:"出价(元)"},min:0,gridLineColor:"#ddd",gridLineDashStyle:"Dash",gridLineWidth:1}],plotOptions:{spline:{marker:{radius:4,lineColor:"#666666",lineWidth:1}}},series:[{cursor:"pointer",name:"出价",lineColor:"#76a0c6",data:i.slice(-18).map(function(t){var e;return e="ok"==t.flag?"/site_media/jl6/static/images/success.png?t=1490089588990":"/site_media/jl6/static/images/fail.png?t=1490089588990",{y:t.price,events:{click:function(){return!1}},marker:{symbol:"url("+e+")",width:20,height:20},data:t}})}],tooltip:{formatter:function(){var t=this.point.data;return"当前出价:"+this.y.toFixed(2)+"元<br/>平台:"+("yd"==t.platform?"移动":"PC")+"   限价:"+t.limit_price+"元<br/>期望排名:"+t.exp_rank_range[0]+"~"+t.exp_rank_range[1]+"<br/>"+t.msg}}}),$("#table_info").find("tbody").html(s.reverse().join())};return{show:n}});