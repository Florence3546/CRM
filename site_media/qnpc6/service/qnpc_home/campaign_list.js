define("site_media/service/qnpc_home/campaign_list",["require","site_media/plugins/artTemplate/template","site_media/plugins/moment/moment.min","site_media/plugins/data-tables/dataTableExt","site_media/widget/ajax/ajax","site_media/widget/loading/loading"],function(t,e,a,n,s,i){"use strict";var o,l=function(t,e){p(t,e),u()},c=function(){var t=[];return $("#campaign_table .check_column input").each(function(){$(this).prop("checked")&&t.push($(this).val())}),t},p=function(t,e){i.show("数据加载中,请稍候..."),s.ajax("campaign_list",{start_date:t,end_date:e},function(t){m(t),i.hide()})},u=function(){$("#campaign_table tbody").on("click",".edit_budget",function(){var e,a,n;a=$(this).closest("tr").data("id"),e=$(this).data("budget"),n=$(this).data("smooth");var i=$(this).closest("tr").attr("mnt_type");t(["site_media/service/qnpc_home/edit_camp_budget"],function(t){t.show({campaign_id:a,budget:e,is_smooth:n,mnt_type:parseInt(i),onChange:function(t,i){if(t!=e||i!=n){var o;o="0"==i?"false":"true",s.ajax("set_budget",{camp_id:a,use_smooth:o,budget:t},function(e){var a=$("#"+e.json_result_data.camp_id).find(".edit_budget"),n=a.prev();n.text(2e7>t?t+"元":"不限"),a.data("budget",t),a.data("smooth",i),$.alert({title:"提示",body:"修改成功！",okBtn:"确定",height:"30px"})})}}})})}),$(".choose_column").change(function(){$(".check_column [type=checkbox]").prop("checked",$(this).prop("checked"))}),$("#campaign_table").change(".check_column [type=checkbox]",function(){$(".check_column [type=checkbox]:checked").length==$("#campaign_table tbody tr").length?$(".choose_column").prop("checked",!0):$(".choose_column").prop("checked",!1)}),$("#campaign_table").on("click",".set_online_status",function(){var t=$(this).closest("tr"),e=$(this).attr("opt"),a=t.data("id");d(e,[a])})},d=function(t,e){var a=new Array;for(var n in e){var i=$("#campaign_table").find("#"+e[n]);i.find(".set_online_status").attr("opt")==t&&a.push(e[n])}s.ajax("set_online_status",{mode:t,camp_id_list:a},function(t){r(t)})},r=function(t){var e=t.success_camp_ids;for(var a in e){var n=$("#campaign_table").find("#"+e[a]);1==t.mode?(n.removeClass("gray_light"),n.find(".set_online_status").attr("opt","0"),n.find(".set_online_status").prev("span").text("推广中"),n.find(".set_online_status").text("暂停")):(n.addClass("gray_light"),n.find(".set_online_status").attr("opt","1"),n.find(".set_online_status").prev("span").text("已暂停"),n.find(".set_online_status").text("开启"))}$.alert({title:"提示",body:"操作成功！",okBtn:"确定",height:"30px"})},m=function(t){o&&(o.fnClearTable(),o.fnDestroy());var a,n='{{each list}}\n<tr data-id="{{$value.campaign_id}}"  id="{{$value.campaign_id}}" mnt_type="{{$value.mnt_type}}" mnt_index="{{$value.mnt_index}}" {{if $value.online_status=="offline"}}class="gray_light"{{/if}}>\n    <td class="check_column" style="border-left: none; text-align: center"><input type="checkbox" value="{{$value.campaign_id}}"></td>\n    <td class="tl">\n      <span class="title">{{$value.title}}</span><br>\n      {{ if $value.mnt_type == 0 }}\n          <span class="sui-label label-">手动</span>\n      {{ else }}\n          <span class="sui-label label-info">\n          {{ if $value.mnt_type == 1}} 长尾\n          {{else if $value.mnt_type == 2}} 重点\n          {{else if $value.mnt_type == 3}} ROI\n          {{else if $value.mnt_type == 4}} 无线\n          {{/if}}\n          </span>\n      {{/if}}\n\n      <span class="ml10">({{$value.adg_num}}个宝贝)</span>\n    </td>\n    <td>\n      <span class="budget">\n          <span class="hidden">{{$value.budget}}</span>\n        {{if $value.budget==20000000}}\n          不限\n        {{else}}\n          {{$value.budget}}元\n        {{/if}}\n      </span>\n      <i class="iconfont edit_budget hover_show" data-budget="{{$value.budget}}" data-smooth="{{$value.is_smooth}}">&#xe604;</i>\n    </td>\n    <td><span class="hide">{{$value.impr}}</span>{{$value.impr}}</td>\n    <td><span class="hide">{{$value.click}}</span>{{$value.click}}</td>\n    <td><span class="hide">{{$value.ctr}}</span>{{$value.ctr}}%</td>\n    <td><span class="hide">{{$value.cost}}</span>￥{{$value.cost}}</td>\n    <td><span class="hide">{{$value.cpc}}</span>￥{{$value.cpc}}</td>\n    <td><span class="hide">{{$value.favcount}}</span>{{$value.favcount}}</td>\n    <td><span class="hide">{{$value.paycount}}</span>{{$value.paycount}}</td>\n    <td><span class="hide">{{$value.conv}}</span>{{$value.conv}}%</td>\n    <td><span class="hide">{{$value.pay}}</span>￥{{$value.pay}}</td>\n    <td><span class="hide">{{$value.roi}}</span>{{$value.roi}}</td>\n    <td>\n\n        <span class="b">\n        {{if $value.online_status=="offline"}}\n        <span>已暂停</span>&emsp;<a href="javascript:;" opt="1" class="hover_show set_online_status">开启</a>\n        {{else}}\n        <span>推广中</span>&emsp;<a href="javascript:;" opt="0" class="hover_show set_online_status">暂停</a>\n        {{/if}}\n        </span>\n        {{ if $value.error_descr }}\n        <br/>{{ $value.error_descr }}\n        {{ /if }}\n    </td>\n</tr>\n{{/each}}\n';a=e.compile(n)({list:t.json_campaign_list}),$("#campaign_table tbody").html(a),o=$("#campaign_table").dataTable({bRetrieve:!0,bPaginate:!1,bDestroy:!0,bFilter:!0,bInfo:!1,bAutoWidth:!1,sDom:"",language:{emptyTable:"<div style='text-align:center'>暂无数据</div>"},aoColumns:[{bSortable:!1},{bSortable:!1},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!0,sType:"custom",sSortDataType:"custom-text"},{bSortable:!1}]})};return{init:l,getCampaignList:p,getCampaignIdList:c,updateCampStatus:d}});