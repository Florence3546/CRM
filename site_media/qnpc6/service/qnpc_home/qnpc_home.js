define("site_media/service/qnpc_home/qnpc_home",["require","site_media/plugins/highcharts/highcharts","site_media/plugins/artTemplate/template","site_media/widget/chart/chart","site_media/service/qnpc_home/campaign_list","site_media/plugins/moment/moment.min","site_media/service/qnpc_home/account_detail","site_media/widget/ajax/ajax","site_media/widget/loading/loading"],function(t,a,n,d,i,r,e,o){function c(t){var a=/^((\+?86)|(\(\+86\)))?(13[0-9]|15[012356789]|17[78]|18[0-9]|14[57])[0-9]{8}$/;return a.test(t)?!0:!1}var s=r().subtract(7,"days").format("YYYY-MM-DD"),l=r().subtract(1,"days").format("YYYY-MM-DD"),u=function(){m(s,l),p(s,l),i.init(s,l),$(".opt-mnt").click(function(){var t=i.getCampaignIdList();if(t.length<=0)return void $.alert({title:"注意",body:"请先选择计划!",okBtn:"确定",height:"60px"});var a="",n=$(this).data("opt");a="1"==n?"确定要推广选中的计划吗?":"确定要将选中的计划暂停推广吗?",$.confirm({title:"提示",body:a,okBtn:"确定",cancelBtn:"取消",okHide:function(){i.updateCampStatus(n,t)}})}),$("#show_detail").click(function(){$("#accountDetailModal").modal("show"),e.hasInit()||e.init()}),$("#select_date").change(function(){var t=Number($(this).val());0==t?(s=r().subtract(0,"days").format("YYYY-MM-DD"),l=r().subtract(0,"days").format("YYYY-MM-DD")):(s=r().subtract(t,"days").format("YYYY-MM-DD"),l=r().subtract(1,"days").format("YYYY-MM-DD")),m(s,l),i.getCampaignList(s,l)}),$("#get_phone_modal")&&($("#inputPhone").tooltip({placement:"right",title:"请输入正确的手机号",trigger:"manual"}),$("#inputPhone").focus(function(){$("#inputPhone").tooltip("hide")}),$("#submit_phone").on("click",function(){var t=$("#inputPhone").val(),a=$("#inputQQ").val();c(t)?o.ajax("submit_userinfo",{phone:t,qq:a},function(){$("#get_phone_modal").modal("hide"),$.alert({title:"提示",body:"提交成功!",okBtn:"确定",height:"60px"})}):$("#inputPhone").tooltip("show")}),$("#get_phone_modal").modal({backdrop:!0,keyboard:!1,okHide:function(){}}),$("#get_phone_modal").modal("show"))},m=function(t,a){o.ajax("account",{start_date:t,end_date:a},function(t){h(t)})},h=function(t){var a,d,i;a='<tr>\r\n    <td rowspan="4" class="none-td">　　</td>\r\n    <td>总花费　</td>\r\n    <td>展现量　</td>\r\n    <td>点击量　</td>\r\n    <td>点击率　</td>\r\n    <td>PPC</td>\r\n    <td>购物车总数</td>\r\n</tr>\r\n<tr class="data">\r\n    <td class="b">￥{{ cost }}</td>\r\n    <td>{{ impr }}</td>\r\n    <td>{{ click }}</td>\r\n    <td>{{ ctr }}%</td>\r\n    <td>{{ cpc }}</td>\r\n    <td>{{ carttotal }}</td>\r\n</tr>\r\n<tr>\r\n    <td>成交额</td>\r\n    <td>收藏量</td>\r\n    <td>成交量</td>\r\n    <td>转化率</td>\r\n    <td>ROI</td>\r\n    <td>成交客单价</td>\r\n</tr>\r\n<tr class="data">\r\n    <td class="b">￥{{ pay }}</td>\r\n    <td>{{ favcount }}</td>\r\n    <td>{{ paycount }}</td>\r\n    <td>{{ conv }}%</td>\r\n    <td>{{ roi }}</td>\r\n    <td>{{ avg_pay }}</td>\r\n</tr>\r\n',i=$(".total_rpt"),d=n.compile(a)(t.account_data_dict),i.html(d)},p=function(){o.ajax("show_chart",{start_date:s,end_date:l},function(t){t.chart_data&&d.draw("account_chart",t.chart_data.category_list,t.chart_data.series_cfg_list)})};return{init:function(){u()}}});